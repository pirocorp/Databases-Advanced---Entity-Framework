//Resharper disable InconsistentNaming, CheckNamespace

using System;
using System.Collections;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Reflection;
using AutoMapper;
using AutoMapper.Configuration;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.DependencyInjection;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using NUnit.Framework;
using TeisterMask;
using TeisterMask.Data;
using TeisterMask.DataProcessor;

[TestFixture]
public class Export_000_001
{
    private IServiceProvider serviceProvider;
    private static Assembly CurrentAssembly;

    [SetUp]
    public void Setup()
    {
        CurrentAssembly = typeof(StartUp).Assembly;

	Mapper.Reset();

        Mapper.Initialize(cfg => cfg.AddProfile(GetType("TeisterMaskProfile")));

        this.serviceProvider = ConfigureServices<TeisterMaskContext>("TeisterMask");
    }

    [Test]
    public void ExportMostBusiestEmployeesZeroTest()
    {
        var context = serviceProvider.GetService<TeisterMaskContext>();

        SeedDatabase(context);
        DateTime dateTime = DateTime.ParseExact("25/01/2018", "dd/MM/yyyy", CultureInfo.InvariantCulture);
        var actualOutputValue = Serializer.ExportMostBusiestEmployees(context, dateTime);
        var actualOutput = JToken.Parse(actualOutputValue);

        var expectedOutputValue =
            "[{\"Username\":\"mmcellen1\",\"Tasks\":[{\"TaskName\":\"Pointed Gourd\",\"OpenDate\":\"10/08/2018\",\"DueDate\":\"10/24/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Columbian\",\"OpenDate\":\"10/24/2018\",\"DueDate\":\"10/20/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Cornflag\",\"OpenDate\":\"09/27/2018\",\"DueDate\":\"09/25/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Charleston Mousetail\",\"OpenDate\":\"08/10/2018\",\"DueDate\":\"07/07/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"California Dwarf-flax\",\"OpenDate\":\"10/01/2018\",\"DueDate\":\"06/01/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Digitgrass\",\"OpenDate\":\"06/02/2018\",\"DueDate\":\"05/18/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Hairy Mountain Mahogany\",\"OpenDate\":\"09/21/2018\",\"DueDate\":\"04/29/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"White\",\"OpenDate\":\"10/04/2018\",\"DueDate\":\"04/21/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Bryum\",\"OpenDate\":\"11/02/2018\",\"DueDate\":\"01/19/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"American Star-thistle\",\"OpenDate\":\"09/21/2018\",\"DueDate\":\"11/29/2018\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Wirestem Buckwheat\",\"OpenDate\":\"04/13/2018\",\"DueDate\":\"11/22/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Spreading Sandwort\",\"OpenDate\":\"02/19/2018\",\"DueDate\":\"11/20/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Cypress Panicgrass\",\"OpenDate\":\"10/19/2018\",\"DueDate\":\"11/17/2018\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Calophyllum\",\"OpenDate\":\"10/09/2018\",\"DueDate\":\"11/15/2018\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"}]},{\"Username\":\"olathleiffurec\",\"Tasks\":[{\"TaskName\":\"Fir Clubmoss\",\"OpenDate\":\"09/15/2018\",\"DueDate\":\"07/08/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Pacific\",\"OpenDate\":\"05/14/2018\",\"DueDate\":\"07/05/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Bicolored Spleenwort\",\"OpenDate\":\"05/24/2018\",\"DueDate\":\"07/02/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Comfortroot\",\"OpenDate\":\"07/14/2018\",\"DueDate\":\"06/10/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Pearson's\",\"OpenDate\":\"03/07/2018\",\"DueDate\":\"05/21/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Digitgrass\",\"OpenDate\":\"06/02/2018\",\"DueDate\":\"05/18/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Bashful Four O'clock\",\"OpenDate\":\"05/08/2018\",\"DueDate\":\"04/21/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Longbract Pohlia Moss\",\"OpenDate\":\"09/13/2018\",\"DueDate\":\"03/29/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Fleabane\",\"OpenDate\":\"10/02/2018\",\"DueDate\":\"03/21/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Carrotwood\",\"OpenDate\":\"07/23/2018\",\"DueDate\":\"03/11/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Lac Tree\",\"OpenDate\":\"06/22/2018\",\"DueDate\":\"02/24/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Greenman's Bluet\",\"OpenDate\":\"07/27/2018\",\"DueDate\":\"02/04/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Clustered Sawwort\",\"OpenDate\":\"07/21/2018\",\"DueDate\":\"12/09/2018\",\"LabelType\":\"Priority\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Calophyllum\",\"OpenDate\":\"10/09/2018\",\"DueDate\":\"11/15/2018\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"}]},{\"Username\":\"pclaffeyq\",\"Tasks\":[{\"TaskName\":\"Fir Clubmoss\",\"OpenDate\":\"09/15/2018\",\"DueDate\":\"07/08/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Annual\",\"OpenDate\":\"05/10/2018\",\"DueDate\":\"06/07/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Pearson's\",\"OpenDate\":\"03/07/2018\",\"DueDate\":\"05/21/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Fineleaf\",\"OpenDate\":\"08/31/2018\",\"DueDate\":\"04/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Roundleaf Leather-root\",\"OpenDate\":\"08/28/2018\",\"DueDate\":\"04/11/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Guadeloupe\",\"OpenDate\":\"02/14/2018\",\"DueDate\":\"02/09/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Greenman's Bluet\",\"OpenDate\":\"07/27/2018\",\"DueDate\":\"02/04/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Florida Toadwood\",\"OpenDate\":\"05/15/2018\",\"DueDate\":\"02/02/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Slender Cudweed\",\"OpenDate\":\"07/12/2018\",\"DueDate\":\"01/24/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Bryum\",\"OpenDate\":\"11/02/2018\",\"DueDate\":\"01/19/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Clustered Sawwort\",\"OpenDate\":\"07/21/2018\",\"DueDate\":\"12/09/2018\",\"LabelType\":\"Priority\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Burchell's Clover\",\"OpenDate\":\"06/17/2018\",\"DueDate\":\"12/03/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Cypress Panicgrass\",\"OpenDate\":\"10/19/2018\",\"DueDate\":\"11/17/2018\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"InProgress\"}]},{\"Username\":\"jbehlingp\",\"Tasks\":[{\"TaskName\":\"Nipa Palm\",\"OpenDate\":\"10/14/2018\",\"DueDate\":\"09/19/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Fir Clubmoss\",\"OpenDate\":\"09/15/2018\",\"DueDate\":\"07/08/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Charleston Mousetail\",\"OpenDate\":\"08/10/2018\",\"DueDate\":\"07/07/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Pacific\",\"OpenDate\":\"05/14/2018\",\"DueDate\":\"07/05/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Bicolored Spleenwort\",\"OpenDate\":\"05/24/2018\",\"DueDate\":\"07/02/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"White\",\"OpenDate\":\"10/04/2018\",\"DueDate\":\"04/21/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Strawberry Clover\",\"OpenDate\":\"10/08/2018\",\"DueDate\":\"04/04/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Florida Toadwood\",\"OpenDate\":\"05/15/2018\",\"DueDate\":\"02/02/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Tricharia Lichen\",\"OpenDate\":\"08/21/2018\",\"DueDate\":\"01/24/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Guadalupe\",\"OpenDate\":\"09/29/2018\",\"DueDate\":\"12/23/2018\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Broadleaf\",\"OpenDate\":\"03/21/2018\",\"DueDate\":\"12/18/2018\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Burchell's Clover\",\"OpenDate\":\"06/17/2018\",\"DueDate\":\"12/03/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"}]},{\"Username\":\"tridolfif\",\"Tasks\":[{\"TaskName\":\"Cornflag\",\"OpenDate\":\"09/27/2018\",\"DueDate\":\"09/25/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Nipa Palm\",\"OpenDate\":\"10/14/2018\",\"DueDate\":\"09/19/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Lane Mountain Milkvetch\",\"OpenDate\":\"08/04/2018\",\"DueDate\":\"07/27/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Southern Hawkweed\",\"OpenDate\":\"10/13/2018\",\"DueDate\":\"06/18/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Digitgrass\",\"OpenDate\":\"06/02/2018\",\"DueDate\":\"05/18/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Bashful Four O'clock\",\"OpenDate\":\"05/08/2018\",\"DueDate\":\"04/21/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Roundleaf Leather-root\",\"OpenDate\":\"08/28/2018\",\"DueDate\":\"04/11/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Lac Tree\",\"OpenDate\":\"06/22/2018\",\"DueDate\":\"02/24/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Crandall\",\"OpenDate\":\"03/12/2018\",\"DueDate\":\"02/21/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Debeque\",\"OpenDate\":\"10/17/2018\",\"DueDate\":\"01/25/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Olive\",\"OpenDate\":\"10/19/2018\",\"DueDate\":\"01/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"}]},{\"Username\":\"mbarendtsena\",\"Tasks\":[{\"TaskName\":\"Columbian\",\"OpenDate\":\"10/24/2018\",\"DueDate\":\"10/20/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Nipa Palm\",\"OpenDate\":\"10/14/2018\",\"DueDate\":\"09/19/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Fir Clubmoss\",\"OpenDate\":\"09/15/2018\",\"DueDate\":\"07/08/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Paradox\",\"OpenDate\":\"05/11/2018\",\"DueDate\":\"05/15/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Fleabane\",\"OpenDate\":\"10/02/2018\",\"DueDate\":\"03/21/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"White Jungleflame\",\"OpenDate\":\"10/10/2018\",\"DueDate\":\"02/11/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Guadeloupe\",\"OpenDate\":\"02/14/2018\",\"DueDate\":\"02/09/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Yellow Wildrye\",\"OpenDate\":\"07/26/2018\",\"DueDate\":\"12/12/2018\",\"LabelType\":\"Priority\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Wirestem Buckwheat\",\"OpenDate\":\"04/13/2018\",\"DueDate\":\"11/22/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Spreading Sandwort\",\"OpenDate\":\"02/19/2018\",\"DueDate\":\"11/20/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"}]},{\"Username\":\"lmarquissn\",\"Tasks\":[{\"TaskName\":\"Charleston Mousetail\",\"OpenDate\":\"08/10/2018\",\"DueDate\":\"07/07/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Leafy Reedgrass\",\"OpenDate\":\"06/22/2018\",\"DueDate\":\"04/28/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Visher's\",\"OpenDate\":\"04/17/2018\",\"DueDate\":\"04/27/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Bashful Four O'clock\",\"OpenDate\":\"05/08/2018\",\"DueDate\":\"04/21/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Fineleaf\",\"OpenDate\":\"08/31/2018\",\"DueDate\":\"04/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Debeque\",\"OpenDate\":\"10/17/2018\",\"DueDate\":\"01/25/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Tricharia Lichen\",\"OpenDate\":\"08/21/2018\",\"DueDate\":\"01/24/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Spreading Sandwort\",\"OpenDate\":\"02/19/2018\",\"DueDate\":\"11/20/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Cyrtandra\",\"OpenDate\":\"08/04/2018\",\"DueDate\":\"11/14/2018\",\"LabelType\":\"Priority\",\"ExecutionType\":\"InProgress\"}]},{\"Username\":\"pnicolsonb\",\"Tasks\":[{\"TaskName\":\"Rubber Rabbitbrush\",\"OpenDate\":\"06/16/2018\",\"DueDate\":\"07/21/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Blueeyed\",\"OpenDate\":\"10/22/2018\",\"DueDate\":\"06/25/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Southern Hawkweed\",\"OpenDate\":\"10/13/2018\",\"DueDate\":\"06/18/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"California Dwarf-flax\",\"OpenDate\":\"10/01/2018\",\"DueDate\":\"06/01/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"White\",\"OpenDate\":\"10/04/2018\",\"DueDate\":\"04/21/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Fineleaf\",\"OpenDate\":\"08/31/2018\",\"DueDate\":\"04/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Guadeloupe\",\"OpenDate\":\"02/14/2018\",\"DueDate\":\"02/09/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Olive\",\"OpenDate\":\"10/19/2018\",\"DueDate\":\"01/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Broadleaf\",\"OpenDate\":\"03/21/2018\",\"DueDate\":\"12/18/2018\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"ProductBacklog\"}]},{\"Username\":\"bbetoniar\",\"Tasks\":[{\"TaskName\":\"Rubber Rabbitbrush\",\"OpenDate\":\"06/16/2018\",\"DueDate\":\"07/21/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Fineleaf\",\"OpenDate\":\"08/31/2018\",\"DueDate\":\"04/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Roundleaf Leather-root\",\"OpenDate\":\"08/28/2018\",\"DueDate\":\"04/11/2019\",\"LabelType\":\"Priority\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Northland\",\"OpenDate\":\"07/31/2018\",\"DueDate\":\"04/06/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Longbract Pohlia Moss\",\"OpenDate\":\"09/13/2018\",\"DueDate\":\"03/29/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Guadeloupe\",\"OpenDate\":\"02/14/2018\",\"DueDate\":\"02/09/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"Greenman's Bluet\",\"OpenDate\":\"07/27/2018\",\"DueDate\":\"02/04/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"American Star-thistle\",\"OpenDate\":\"09/21/2018\",\"DueDate\":\"11/29/2018\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"ProductBacklog\"}]},{\"Username\":\"btorrejond\",\"Tasks\":[{\"TaskName\":\"Rubber Rabbitbrush\",\"OpenDate\":\"06/16/2018\",\"DueDate\":\"07/21/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Spherical Blazing Star\",\"OpenDate\":\"10/15/2018\",\"DueDate\":\"03/08/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Lac Tree\",\"OpenDate\":\"06/22/2018\",\"DueDate\":\"02/24/2019\",\"LabelType\":\"JavaAdvanced\",\"ExecutionType\":\"SprintBacklog\"},{\"TaskName\":\"White Jungleflame\",\"OpenDate\":\"10/10/2018\",\"DueDate\":\"02/11/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"Finished\"},{\"TaskName\":\"Greenman's Bluet\",\"OpenDate\":\"07/27/2018\",\"DueDate\":\"02/04/2019\",\"LabelType\":\"CSharpAdvanced\",\"ExecutionType\":\"InProgress\"},{\"TaskName\":\"Bryum\",\"OpenDate\":\"11/02/2018\",\"DueDate\":\"01/19/2019\",\"LabelType\":\"EntityFramework\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Olive\",\"OpenDate\":\"10/19/2018\",\"DueDate\":\"01/18/2019\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"ProductBacklog\"},{\"TaskName\":\"Spreading Sandwort\",\"OpenDate\":\"02/19/2018\",\"DueDate\":\"11/20/2018\",\"LabelType\":\"Hibernate\",\"ExecutionType\":\"InProgress\"}]}]";

        var expectedOutput = JToken.Parse(expectedOutputValue);

        var expected = expectedOutput.ToString(Formatting.Indented);
        var actual = actualOutput.ToString(Formatting.Indented);

        Assert.That(actual, Is.EqualTo(expected).NoClip,
            $"{nameof(Serializer.ExportProjectWithTheirTasks)} output is incorrect!");
    }

    private static void SeedDatabase(TeisterMaskContext context)
    {
        var datasetsJson =
            "{\"Project\":[{\"Id\":1,\"Name\":\"America\",\"OpenDate\":\"2018-06-19T00:00:00\",\"DueDate\":\"2019-10-26T00:00:00\"},{\"Id\":2,\"Name\":\"New Oriental\",\"OpenDate\":\"2018-01-27T00:00:00\",\"DueDate\":\"2019-07-25T00:00:00\"},{\"Id\":3,\"Name\":\"Two River Bancorp\",\"OpenDate\":\"2018-04-04T00:00:00\",\"DueDate\":\"2019-07-26T00:00:00\"},{\"Id\":4,\"Name\":\"Perceptron, Inc.\",\"OpenDate\":\"2018-02-20T00:00:00\",\"DueDate\":\"2018-12-15T00:00:00\"},{\"Id\":5,\"Name\":\"National Beverage Corp.\",\"OpenDate\":\"2018-03-16T00:00:00\",\"DueDate\":\"2019-03-28T00:00:00\"},{\"Id\":6,\"Name\":\"China Lending Corporation\",\"OpenDate\":\"2018-02-02T00:00:00\",\"DueDate\":null},{\"Id\":7,\"Name\":\"American National Bankshares, Inc.\",\"OpenDate\":\"2018-08-14T00:00:00\",\"DueDate\":\"2019-02-11T00:00:00\"},{\"Id\":8,\"Name\":\"Sumitomo Mitsui\",\"OpenDate\":\"2018-01-04T00:00:00\",\"DueDate\":\"2018-11-28T00:00:00\"},{\"Id\":9,\"Name\":\"Public Storage\",\"OpenDate\":\"2018-07-02T00:00:00\",\"DueDate\":null},{\"Id\":10,\"Name\":\"Cellectis S.A.\",\"OpenDate\":\"2018-03-18T00:00:00\",\"DueDate\":\"2019-02-15T00:00:00\"},{\"Id\":11,\"Name\":\"SS S.A.\",\"OpenDate\":\"2018-09-19T00:00:00\",\"DueDate\":\"2019-04-21T00:00:00\"},{\"Id\":12,\"Name\":\"Key Energy Services, Inc.\",\"OpenDate\":\"2018-08-16T00:00:00\",\"DueDate\":null},{\"Id\":13,\"Name\":\"Alamos Gold Inc.\",\"OpenDate\":\"2018-01-01T00:00:00\",\"DueDate\":null},{\"Id\":14,\"Name\":\"Atlas Air\",\"OpenDate\":\"2018-10-23T00:00:00\",\"DueDate\":\"2019-01-12T00:00:00\"},{\"Id\":15,\"Name\":\"U.S. Bancorp\",\"OpenDate\":\"2018-01-22T00:00:00\",\"DueDate\":\"2019-07-14T00:00:00\"},{\"Id\":16,\"Name\":\"Medley Capital Corporation\",\"OpenDate\":\"2018-02-14T00:00:00\",\"DueDate\":\"2018-12-25T00:00:00\"},{\"Id\":17,\"Name\":\"Magna Inc.\",\"OpenDate\":\"2018-06-28T00:00:00\",\"DueDate\":\"2019-02-03T00:00:00\"},{\"Id\":18,\"Name\":\"Caleres, Inc.\",\"OpenDate\":\"2018-07-06T00:00:00\",\"DueDate\":null},{\"Id\":19,\"Name\":\"First Trust Senior Loan Fund ETF\",\"OpenDate\":\"2018-04-02T00:00:00\",\"DueDate\":\"2019-01-21T00:00:00\"},{\"Id\":20,\"Name\":\"Tekla Life\",\"OpenDate\":\"2018-10-11T00:00:00\",\"DueDate\":\"2018-12-08T00:00:00\"},{\"Id\":21,\"Name\":\"TearLab Corporation\",\"OpenDate\":\"2018-03-08T00:00:00\",\"DueDate\":\"2019-05-05T00:00:00\"},{\"Id\":22,\"Name\":\"SCYNEXIS, Inc.\",\"OpenDate\":\"2018-07-18T00:00:00\",\"DueDate\":\"2019-07-26T00:00:00\"},{\"Id\":23,\"Name\":\"Hyster-Yale\",\"OpenDate\":\"2018-02-05T00:00:00\",\"DueDate\":null},{\"Id\":24,\"Name\":\"Vical\",\"OpenDate\":\"2018-08-19T00:00:00\",\"DueDate\":\"2019-02-14T00:00:00\"},{\"Id\":25,\"Name\":\"PPL Corporation\",\"OpenDate\":\"2018-09-30T00:00:00\",\"DueDate\":null},{\"Id\":26,\"Name\":\"Land Systemttttttttttttttttttttttttttt\",\"OpenDate\":\"2018-03-16T00:00:00\",\"DueDate\":null},{\"Id\":27,\"Name\":\"Cypress Energy\",\"OpenDate\":\"2018-07-22T00:00:00\",\"DueDate\":\"2019-04-13T00:00:00\"},{\"Id\":28,\"Name\":\"Boston\",\"OpenDate\":\"2018-03-06T00:00:00\",\"DueDate\":\"2019-02-26T00:00:00\"},{\"Id\":29,\"Name\":\"TESARO, Inc.\",\"OpenDate\":\"2018-06-20T00:00:00\",\"DueDate\":\"2019-05-13T00:00:00\"},{\"Id\":30,\"Name\":\"Net 1 UEPS Technologies, Inc.\",\"OpenDate\":\"2018-01-20T00:00:00\",\"DueDate\":\"2019-04-02T00:00:00\"},{\"Id\":31,\"Name\":\"Interpace 22.\",\"OpenDate\":\"2018-10-20T00:00:00\",\"DueDate\":\"2019-01-19T00:00:00\"},{\"Id\":32,\"Name\":\"L Brands, Inc.\",\"OpenDate\":\"2018-10-24T00:00:00\",\"DueDate\":\"2019-03-14T00:00:00\"},{\"Id\":33,\"Name\":\"Postman\",\"OpenDate\":\"2018-11-01T00:00:00\",\"DueDate\":\"2019-06-10T00:00:00\"},{\"Id\":34,\"Name\":\"VivoPower PLC\",\"OpenDate\":\"2018-01-02T00:00:00\",\"DueDate\":\"2019-08-30T00:00:00\"},{\"Id\":35,\"Name\":\"Arbor Trust\",\"OpenDate\":\"2018-09-01T00:00:00\",\"DueDate\":\"2019-09-05T00:00:00\"},{\"Id\":36,\"Name\":\"Greenbrier Companies\",\"OpenDate\":\"2018-02-02T00:00:00\",\"DueDate\":\"2019-05-23T00:00:00\"},{\"Id\":37,\"Name\":\"BBVA Banco Frances S.A.\",\"OpenDate\":\"2018-01-04T00:00:00\",\"DueDate\":\"2018-12-11T00:00:00\"},{\"Id\":38,\"Name\":\"First22\",\"OpenDate\":\"2018-05-22T00:00:00\",\"DueDate\":\"2019-01-23T00:00:00\"},{\"Id\":39,\"Name\":\"Brandywine\",\"OpenDate\":\"2018-10-15T00:00:00\",\"DueDate\":\"2019-07-21T00:00:00\"},{\"Id\":40,\"Name\":\"America Corporation\",\"OpenDate\":\"2018-09-16T00:00:00\",\"DueDate\":\"2019-03-02T00:00:00\"},{\"Id\":41,\"Name\":\"Blackrock MuniHoldings\",\"OpenDate\":\"2018-06-09T00:00:00\",\"DueDate\":\"2019-03-13T00:00:00\"},{\"Id\":42,\"Name\":\"USANA Health Sciences, Inc.\",\"OpenDate\":\"2018-05-28T00:00:00\",\"DueDate\":\"2019-11-04T00:00:00\"}],\"Task\":[{\"Id\":1,\"Name\":\"California Dwarf-flax\",\"OpenDate\":\"2018-10-01T00:00:00\",\"DueDate\":\"2019-06-01T00:00:00\",\"ExecutionType\":3,\"LabelType\":4,\"ProjectId\":1},{\"Id\":2,\"Name\":\"Calophyllum\",\"OpenDate\":\"2018-10-09T00:00:00\",\"DueDate\":\"2018-11-15T00:00:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":36},{\"Id\":3,\"Name\":\"Awned Mountainmint\",\"OpenDate\":\"2018-10-19T00:00:00\",\"DueDate\":\"2019-04-17T00:00:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":36},{\"Id\":4,\"Name\":\"Cypress Panicgrass\",\"OpenDate\":\"2018-10-19T00:00:00\",\"DueDate\":\"2018-11-17T00:00:00\",\"ExecutionType\":2,\"LabelType\":3,\"ProjectId\":39},{\"Id\":5,\"Name\":\"American Star-thistle\",\"OpenDate\":\"2018-09-21T00:00:00\",\"DueDate\":\"2018-11-29T00:00:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":22},{\"Id\":6,\"Name\":\"Hairy Mountain Mahogany\",\"OpenDate\":\"2018-09-21T00:00:00\",\"DueDate\":\"2019-04-29T00:00:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":22},{\"Id\":7,\"Name\":\"Yellow Wildrye\",\"OpenDate\":\"2018-07-26T00:00:00\",\"DueDate\":\"2018-12-12T00:00:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":22},{\"Id\":8,\"Name\":\"Cyrtandra\",\"OpenDate\":\"2018-08-04T00:00:00\",\"DueDate\":\"2018-11-14T00:00:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":19},{\"Id\":9,\"Name\":\"Rubber Rabbitbrush\",\"OpenDate\":\"2018-06-16T00:00:00\",\"DueDate\":\"2019-07-21T00:00:00\",\"ExecutionType\":2,\"LabelType\":2,\"ProjectId\":2},{\"Id\":10,\"Name\":\"Bashful Four O'clock\",\"OpenDate\":\"2018-05-08T00:00:00\",\"DueDate\":\"2019-04-21T00:00:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":2},{\"Id\":11,\"Name\":\"Sea Kale\",\"OpenDate\":\"2018-02-10T00:00:00\",\"DueDate\":\"2019-07-03T00:00:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":2},{\"Id\":12,\"Name\":\"Burchell's Clover\",\"OpenDate\":\"2018-06-17T00:00:00\",\"DueDate\":\"2018-12-03T00:00:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":2},{\"Id\":13,\"Name\":\"Wirestem Buckwheat\",\"OpenDate\":\"2018-04-13T00:00:00\",\"DueDate\":\"2018-11-22T00:00:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":4},{\"Id\":14,\"Name\":\"Carrotwood\",\"OpenDate\":\"2018-07-23T00:00:00\",\"DueDate\":\"2019-03-11T00:00:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":5},{\"Id\":15,\"Name\":\"Spreading Sandwort\",\"OpenDate\":\"2018-02-19T00:00:00\",\"DueDate\":\"2018-11-20T00:00:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":6},{\"Id\":16,\"Name\":\"Fir Clubmoss\",\"OpenDate\":\"2018-09-15T00:00:00\",\"DueDate\":\"2019-07-08T00:00:00\",\"ExecutionType\":3,\"LabelType\":3,\"ProjectId\":9},{\"Id\":17,\"Name\":\"Clustered Sawwort\",\"OpenDate\":\"2018-07-21T00:00:00\",\"DueDate\":\"2018-12-09T00:00:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":9},{\"Id\":18,\"Name\":\"Strawberry Clover\",\"OpenDate\":\"2018-10-08T00:00:00\",\"DueDate\":\"2019-04-04T00:00:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":11},{\"Id\":19,\"Name\":\"Roundleaf Leather-root\",\"OpenDate\":\"2018-08-28T00:00:00\",\"DueDate\":\"2019-04-11T00:00:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":12},{\"Id\":20,\"Name\":\"Columbian\",\"OpenDate\":\"2018-10-24T00:00:00\",\"DueDate\":\"2019-10-20T00:00:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":12},{\"Id\":21,\"Name\":\"Comfortroot\",\"OpenDate\":\"2018-07-14T00:00:00\",\"DueDate\":\"2019-06-10T00:00:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":13},{\"Id\":22,\"Name\":\"Bicolored Spleenwort\",\"OpenDate\":\"2018-05-24T00:00:00\",\"DueDate\":\"2019-07-02T00:00:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":13},{\"Id\":23,\"Name\":\"Valamuerto\",\"OpenDate\":\"2018-08-23T00:00:00\",\"DueDate\":\"2019-01-15T00:00:00\",\"ExecutionType\":3,\"LabelType\":4,\"ProjectId\":15},{\"Id\":24,\"Name\":\"Munz's Buckwheat\",\"OpenDate\":\"2018-07-18T00:00:00\",\"DueDate\":\"2018-12-18T00:00:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":15},{\"Id\":25,\"Name\":\"Florida Toadwood\",\"OpenDate\":\"2018-05-15T00:00:00\",\"DueDate\":\"2019-02-02T00:00:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":15},{\"Id\":26,\"Name\":\"Visher's\",\"OpenDate\":\"2018-04-17T00:00:00\",\"DueDate\":\"2019-04-27T00:00:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":15},{\"Id\":27,\"Name\":\"Pointed Gourd\",\"OpenDate\":\"2018-10-08T00:00:00\",\"DueDate\":\"2019-10-24T00:00:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":42},{\"Id\":28,\"Name\":\"Lac Tree\",\"OpenDate\":\"2018-06-22T00:00:00\",\"DueDate\":\"2019-02-24T00:00:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":42},{\"Id\":29,\"Name\":\"Pearson's\",\"OpenDate\":\"2018-03-07T00:00:00\",\"DueDate\":\"2019-05-21T00:00:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":36},{\"Id\":30,\"Name\":\"Rock Whitefeather\",\"OpenDate\":\"2018-01-23T00:00:00\",\"DueDate\":\"2019-08-24T00:00:00\",\"ExecutionType\":1,\"LabelType\":4,\"ProjectId\":34},{\"Id\":31,\"Name\":\"Digitgrass\",\"OpenDate\":\"2018-06-02T00:00:00\",\"DueDate\":\"2019-05-18T00:00:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":34},{\"Id\":32,\"Name\":\"Saber Bogmat\",\"OpenDate\":\"2018-08-16T00:00:00\",\"DueDate\":\"2019-03-12T00:00:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":41},{\"Id\":33,\"Name\":\"Fineleaf\",\"OpenDate\":\"2018-08-31T00:00:00\",\"DueDate\":\"2019-04-18T00:00:00\",\"ExecutionType\":0,\"LabelType\":4,\"ProjectId\":1},{\"Id\":34,\"Name\":\"Broadleaf\",\"OpenDate\":\"2018-03-21T00:00:00\",\"DueDate\":\"2018-12-18T00:00:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":23},{\"Id\":35,\"Name\":\"Cornflag\",\"OpenDate\":\"2018-09-27T00:00:00\",\"DueDate\":\"2019-09-25T00:00:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":23},{\"Id\":36,\"Name\":\"Debeque\",\"OpenDate\":\"2018-10-17T00:00:00\",\"DueDate\":\"2019-01-25T00:00:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":23},{\"Id\":37,\"Name\":\"Bryum\",\"OpenDate\":\"2018-11-02T00:00:00\",\"DueDate\":\"2019-01-19T00:00:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":23},{\"Id\":38,\"Name\":\"Pacific\",\"OpenDate\":\"2018-05-14T00:00:00\",\"DueDate\":\"2019-07-05T00:00:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":23},{\"Id\":39,\"Name\":\"Guadalupe\",\"OpenDate\":\"2018-09-29T00:00:00\",\"DueDate\":\"2018-12-23T00:00:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":23},{\"Id\":40,\"Name\":\"Crandall\",\"OpenDate\":\"2018-03-12T00:00:00\",\"DueDate\":\"2019-02-21T00:00:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":23},{\"Id\":41,\"Name\":\"Longbract Pohlia Moss\",\"OpenDate\":\"2018-09-13T00:00:00\",\"DueDate\":\"2019-03-29T00:00:00\",\"ExecutionType\":2,\"LabelType\":3,\"ProjectId\":23},{\"Id\":42,\"Name\":\"Guadeloupe\",\"OpenDate\":\"2018-02-14T00:00:00\",\"DueDate\":\"2019-02-09T00:00:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":23},{\"Id\":43,\"Name\":\"Meyen's Sedge\",\"OpenDate\":\"2018-10-09T00:00:00\",\"DueDate\":\"2019-05-05T00:00:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":23},{\"Id\":44,\"Name\":\"White\",\"OpenDate\":\"2018-10-04T00:00:00\",\"DueDate\":\"2019-04-21T00:00:00\",\"ExecutionType\":1,\"LabelType\":4,\"ProjectId\":26},{\"Id\":45,\"Name\":\"Blueeyed\",\"OpenDate\":\"2018-10-22T00:00:00\",\"DueDate\":\"2019-06-25T00:00:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":26},{\"Id\":46,\"Name\":\"Southern Hawkweed\",\"OpenDate\":\"2018-10-13T00:00:00\",\"DueDate\":\"2019-06-18T00:00:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":42},{\"Id\":47,\"Name\":\"Paradox\",\"OpenDate\":\"2018-05-11T00:00:00\",\"DueDate\":\"2019-05-15T00:00:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":26},{\"Id\":48,\"Name\":\"Nipa Palm\",\"OpenDate\":\"2018-10-14T00:00:00\",\"DueDate\":\"2019-09-19T00:00:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":26},{\"Id\":49,\"Name\":\"Charleston Mousetail\",\"OpenDate\":\"2018-08-10T00:00:00\",\"DueDate\":\"2019-07-07T00:00:00\",\"ExecutionType\":0,\"LabelType\":4,\"ProjectId\":26},{\"Id\":50,\"Name\":\"Northland\",\"OpenDate\":\"2018-07-31T00:00:00\",\"DueDate\":\"2019-04-06T00:00:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":26},{\"Id\":51,\"Name\":\"Tricharia Lichen\",\"OpenDate\":\"2018-08-21T00:00:00\",\"DueDate\":\"2019-01-24T00:00:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":27},{\"Id\":52,\"Name\":\"Sturdy Bulrush\",\"OpenDate\":\"2018-10-25T00:00:00\",\"DueDate\":\"2018-11-20T00:00:00\",\"ExecutionType\":1,\"LabelType\":3,\"ProjectId\":28},{\"Id\":53,\"Name\":\"White Jungleflame\",\"OpenDate\":\"2018-10-10T00:00:00\",\"DueDate\":\"2019-02-11T00:00:00\",\"ExecutionType\":3,\"LabelType\":4,\"ProjectId\":28},{\"Id\":54,\"Name\":\"Fleabane\",\"OpenDate\":\"2018-10-02T00:00:00\",\"DueDate\":\"2019-03-21T00:00:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":29},{\"Id\":55,\"Name\":\"Spherical Blazing Star\",\"OpenDate\":\"2018-10-15T00:00:00\",\"DueDate\":\"2019-03-08T00:00:00\",\"ExecutionType\":3,\"LabelType\":4,\"ProjectId\":29},{\"Id\":56,\"Name\":\"Olive\",\"OpenDate\":\"2018-10-19T00:00:00\",\"DueDate\":\"2019-01-18T00:00:00\",\"ExecutionType\":0,\"LabelType\":4,\"ProjectId\":29},{\"Id\":57,\"Name\":\"Slender Cudweed\",\"OpenDate\":\"2018-07-12T00:00:00\",\"DueDate\":\"2019-01-24T00:00:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":29},{\"Id\":58,\"Name\":\"Leafy Reedgrass\",\"OpenDate\":\"2018-06-22T00:00:00\",\"DueDate\":\"2019-04-28T00:00:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":29},{\"Id\":59,\"Name\":\"Greenman's Bluet\",\"OpenDate\":\"2018-07-27T00:00:00\",\"DueDate\":\"2019-02-04T00:00:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":30},{\"Id\":60,\"Name\":\"Spotted Phacelia\",\"OpenDate\":\"2018-06-14T00:00:00\",\"DueDate\":\"2018-12-02T00:00:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":30},{\"Id\":61,\"Name\":\"Annual\",\"OpenDate\":\"2018-05-10T00:00:00\",\"DueDate\":\"2019-06-07T00:00:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":26},{\"Id\":62,\"Name\":\"Lane Mountain Milkvetch\",\"OpenDate\":\"2018-08-04T00:00:00\",\"DueDate\":\"2019-07-27T00:00:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":42}],\"Employee\":[{\"Id\":1,\"Username\":\"jstanett0\",\"Email\":\"kknapper0@opera.com\",\"Phone\":\"819-699-1096\"},{\"Id\":2,\"Username\":\"pclaffeyq\",\"Email\":\"cussherq@tumblr.com\",\"Phone\":\"225-876-9150\"},{\"Id\":3,\"Username\":\"jbehlingp\",\"Email\":\"crogetp@imdb.com\",\"Phone\":\"470-834-7902\"},{\"Id\":4,\"Username\":\"ocoolsono\",\"Email\":\"dchadbourneo@com.com\",\"Phone\":\"105-464-2474\"},{\"Id\":5,\"Username\":\"lmarquissn\",\"Email\":\"graglessn@berkeley.edu\",\"Phone\":\"239-404-5576\"},{\"Id\":6,\"Username\":\"mobispom\",\"Email\":\"smcdonoghm@jimdo.com\",\"Phone\":\"589-982-5040\"},{\"Id\":7,\"Username\":\"mkyncll\",\"Email\":\"jbarbierl@imdb.com\",\"Phone\":\"184-104-0626\"},{\"Id\":8,\"Username\":\"emccarryk\",\"Email\":\"wgrindrodk@mysql.com\",\"Phone\":\"959-210-4953\"},{\"Id\":9,\"Username\":\"ehawtoni\",\"Email\":\"prousselli@artisteer.com\",\"Phone\":\"113-391-9570\"},{\"Id\":10,\"Username\":\"gkeemsh\",\"Email\":\"qcaulfieldh@dropbox.com\",\"Phone\":\"904-722-6709\"},{\"Id\":11,\"Username\":\"sthynneg\",\"Email\":\"rderocheg@techcrunch.com\",\"Phone\":\"194-364-8234\"},{\"Id\":12,\"Username\":\"bbetoniar\",\"Email\":\"crosternr@bloglines.com\",\"Phone\":\"512-373-2485\"},{\"Id\":13,\"Username\":\"tridolfif\",\"Email\":\"eterrazzof@slideshare.net\",\"Phone\":\"262-575-8196\"},{\"Id\":14,\"Username\":\"btorrejond\",\"Email\":\"nskerrittd@mashable.com\",\"Phone\":\"405-758-1588\"},{\"Id\":15,\"Username\":\"olathleiffurec\",\"Email\":\"aspohrmannc@ezinearticles.com\",\"Phone\":\"782-166-4860\"},{\"Id\":16,\"Username\":\"pnicolsonb\",\"Email\":\"dbeinckenb@earthlink.net\",\"Phone\":\"349-526-0430\"},{\"Id\":17,\"Username\":\"mbarendtsena\",\"Email\":\"srountreea@google.it\",\"Phone\":\"567-348-2054\"},{\"Id\":18,\"Username\":\"qfilkin7\",\"Email\":\"mhanselmann7@soundcloud.com\",\"Phone\":\"678-790-6495\"},{\"Id\":19,\"Username\":\"codaly6\",\"Email\":\"rhaglington6@hibu.com\",\"Phone\":\"305-464-1823\"},{\"Id\":20,\"Username\":\"dnapton4\",\"Email\":\"asprey4@businessinsider.com\",\"Phone\":\"235-815-6395\"},{\"Id\":21,\"Username\":\"mdilucia3\",\"Email\":\"nangus3@about.com\",\"Phone\":\"973-545-0173\"},{\"Id\":22,\"Username\":\"cmartinho2\",\"Email\":\"kgosse2@aol.com\",\"Phone\":\"958-128-8777\"},{\"Id\":23,\"Username\":\"mmcellen1\",\"Email\":\"emorten1@ucla.edu\",\"Phone\":\"806-478-7549\"},{\"Id\":24,\"Username\":\"mdivere\",\"Email\":\"shawarde@squarespace.com\",\"Phone\":\"888-104-4239\"},{\"Id\":25,\"Username\":\"hgreenhaughs\",\"Email\":\"ebirkbys@bandcamp.com\",\"Phone\":\"622-909-9951\"}],\"EmployeeTask\":[{\"EmployeeId\":16,\"TaskId\":1},{\"EmployeeId\":23,\"TaskId\":1},{\"EmployeeId\":15,\"TaskId\":2},{\"EmployeeId\":23,\"TaskId\":2},{\"EmployeeId\":6,\"TaskId\":3},{\"EmployeeId\":10,\"TaskId\":3},{\"EmployeeId\":24,\"TaskId\":3},{\"EmployeeId\":2,\"TaskId\":4},{\"EmployeeId\":4,\"TaskId\":4},{\"EmployeeId\":19,\"TaskId\":4},{\"EmployeeId\":23,\"TaskId\":4},{\"EmployeeId\":12,\"TaskId\":5},{\"EmployeeId\":19,\"TaskId\":5},{\"EmployeeId\":23,\"TaskId\":5},{\"EmployeeId\":6,\"TaskId\":6},{\"EmployeeId\":11,\"TaskId\":6},{\"EmployeeId\":23,\"TaskId\":6},{\"EmployeeId\":4,\"TaskId\":7},{\"EmployeeId\":17,\"TaskId\":7},{\"EmployeeId\":21,\"TaskId\":7},{\"EmployeeId\":5,\"TaskId\":8},{\"EmployeeId\":8,\"TaskId\":8},{\"EmployeeId\":24,\"TaskId\":8},{\"EmployeeId\":6,\"TaskId\":9},{\"EmployeeId\":12,\"TaskId\":9},{\"EmployeeId\":14,\"TaskId\":9},{\"EmployeeId\":16,\"TaskId\":9},{\"EmployeeId\":21,\"TaskId\":9},{\"EmployeeId\":25,\"TaskId\":9},{\"EmployeeId\":5,\"TaskId\":10},{\"EmployeeId\":9,\"TaskId\":10},{\"EmployeeId\":13,\"TaskId\":10},{\"EmployeeId\":15,\"TaskId\":10},{\"EmployeeId\":20,\"TaskId\":11},{\"EmployeeId\":2,\"TaskId\":12},{\"EmployeeId\":3,\"TaskId\":12},{\"EmployeeId\":20,\"TaskId\":12},{\"EmployeeId\":11,\"TaskId\":13},{\"EmployeeId\":17,\"TaskId\":13},{\"EmployeeId\":19,\"TaskId\":13},{\"EmployeeId\":23,\"TaskId\":13},{\"EmployeeId\":4,\"TaskId\":14},{\"EmployeeId\":15,\"TaskId\":14},{\"EmployeeId\":5,\"TaskId\":15},{\"EmployeeId\":7,\"TaskId\":15},{\"EmployeeId\":14,\"TaskId\":15},{\"EmployeeId\":17,\"TaskId\":15},{\"EmployeeId\":18,\"TaskId\":15},{\"EmployeeId\":23,\"TaskId\":15},{\"EmployeeId\":2,\"TaskId\":16},{\"EmployeeId\":3,\"TaskId\":16},{\"EmployeeId\":15,\"TaskId\":16},{\"EmployeeId\":17,\"TaskId\":16},{\"EmployeeId\":19,\"TaskId\":16},{\"EmployeeId\":2,\"TaskId\":17},{\"EmployeeId\":15,\"TaskId\":17},{\"EmployeeId\":24,\"TaskId\":17},{\"EmployeeId\":3,\"TaskId\":18},{\"EmployeeId\":18,\"TaskId\":18},{\"EmployeeId\":2,\"TaskId\":19},{\"EmployeeId\":10,\"TaskId\":19},{\"EmployeeId\":12,\"TaskId\":19},{\"EmployeeId\":13,\"TaskId\":19},{\"EmployeeId\":17,\"TaskId\":20},{\"EmployeeId\":23,\"TaskId\":20},{\"EmployeeId\":9,\"TaskId\":21},{\"EmployeeId\":15,\"TaskId\":21},{\"EmployeeId\":19,\"TaskId\":21},{\"EmployeeId\":3,\"TaskId\":22},{\"EmployeeId\":7,\"TaskId\":22},{\"EmployeeId\":8,\"TaskId\":22},{\"EmployeeId\":15,\"TaskId\":22},{\"EmployeeId\":22,\"TaskId\":22},{\"EmployeeId\":6,\"TaskId\":23},{\"EmployeeId\":25,\"TaskId\":24},{\"EmployeeId\":2,\"TaskId\":25},{\"EmployeeId\":3,\"TaskId\":25},{\"EmployeeId\":21,\"TaskId\":25},{\"EmployeeId\":5,\"TaskId\":26},{\"EmployeeId\":11,\"TaskId\":26},{\"EmployeeId\":20,\"TaskId\":26},{\"EmployeeId\":22,\"TaskId\":26},{\"EmployeeId\":23,\"TaskId\":27},{\"EmployeeId\":13,\"TaskId\":28},{\"EmployeeId\":14,\"TaskId\":28},{\"EmployeeId\":15,\"TaskId\":28},{\"EmployeeId\":2,\"TaskId\":29},{\"EmployeeId\":10,\"TaskId\":29},{\"EmployeeId\":15,\"TaskId\":29},{\"EmployeeId\":19,\"TaskId\":29},{\"EmployeeId\":1,\"TaskId\":30},{\"EmployeeId\":3,\"TaskId\":30},{\"EmployeeId\":14,\"TaskId\":30},{\"EmployeeId\":21,\"TaskId\":30},{\"EmployeeId\":23,\"TaskId\":30},{\"EmployeeId\":7,\"TaskId\":31},{\"EmployeeId\":8,\"TaskId\":31},{\"EmployeeId\":13,\"TaskId\":31},{\"EmployeeId\":15,\"TaskId\":31},{\"EmployeeId\":23,\"TaskId\":31},{\"EmployeeId\":1,\"TaskId\":32},{\"EmployeeId\":7,\"TaskId\":32},{\"EmployeeId\":2,\"TaskId\":33},{\"EmployeeId\":5,\"TaskId\":33},{\"EmployeeId\":12,\"TaskId\":33},{\"EmployeeId\":16,\"TaskId\":33},{\"EmployeeId\":1,\"TaskId\":34},{\"EmployeeId\":3,\"TaskId\":34},{\"EmployeeId\":4,\"TaskId\":34},{\"EmployeeId\":16,\"TaskId\":34},{\"EmployeeId\":18,\"TaskId\":34},{\"EmployeeId\":21,\"TaskId\":34},{\"EmployeeId\":6,\"TaskId\":35},{\"EmployeeId\":7,\"TaskId\":35},{\"EmployeeId\":13,\"TaskId\":35},{\"EmployeeId\":20,\"TaskId\":35},{\"EmployeeId\":21,\"TaskId\":35},{\"EmployeeId\":23,\"TaskId\":35},{\"EmployeeId\":1,\"TaskId\":36},{\"EmployeeId\":5,\"TaskId\":36},{\"EmployeeId\":13,\"TaskId\":36},{\"EmployeeId\":22,\"TaskId\":36},{\"EmployeeId\":2,\"TaskId\":37},{\"EmployeeId\":11,\"TaskId\":37},{\"EmployeeId\":14,\"TaskId\":37},{\"EmployeeId\":21,\"TaskId\":37},{\"EmployeeId\":22,\"TaskId\":37},{\"EmployeeId\":23,\"TaskId\":37},{\"EmployeeId\":3,\"TaskId\":38},{\"EmployeeId\":6,\"TaskId\":38},{\"EmployeeId\":15,\"TaskId\":38},{\"EmployeeId\":3,\"TaskId\":39},{\"EmployeeId\":19,\"TaskId\":39},{\"EmployeeId\":13,\"TaskId\":40},{\"EmployeeId\":12,\"TaskId\":41},{\"EmployeeId\":15,\"TaskId\":41},{\"EmployeeId\":24,\"TaskId\":41},{\"EmployeeId\":2,\"TaskId\":42},{\"EmployeeId\":7,\"TaskId\":42},{\"EmployeeId\":8,\"TaskId\":42},{\"EmployeeId\":12,\"TaskId\":42},{\"EmployeeId\":16,\"TaskId\":42},{\"EmployeeId\":17,\"TaskId\":42},{\"EmployeeId\":4,\"TaskId\":43},{\"EmployeeId\":3,\"TaskId\":44},{\"EmployeeId\":16,\"TaskId\":44},{\"EmployeeId\":23,\"TaskId\":44},{\"EmployeeId\":25,\"TaskId\":44},{\"EmployeeId\":1,\"TaskId\":45},{\"EmployeeId\":16,\"TaskId\":45},{\"EmployeeId\":25,\"TaskId\":45},{\"EmployeeId\":13,\"TaskId\":46},{\"EmployeeId\":16,\"TaskId\":46},{\"EmployeeId\":6,\"TaskId\":47},{\"EmployeeId\":17,\"TaskId\":47},{\"EmployeeId\":3,\"TaskId\":48},{\"EmployeeId\":13,\"TaskId\":48},{\"EmployeeId\":17,\"TaskId\":48},{\"EmployeeId\":25,\"TaskId\":48},{\"EmployeeId\":3,\"TaskId\":49},{\"EmployeeId\":5,\"TaskId\":49},{\"EmployeeId\":21,\"TaskId\":49},{\"EmployeeId\":23,\"TaskId\":49},{\"EmployeeId\":12,\"TaskId\":50},{\"EmployeeId\":3,\"TaskId\":51},{\"EmployeeId\":5,\"TaskId\":51},{\"EmployeeId\":21,\"TaskId\":51},{\"EmployeeId\":14,\"TaskId\":53},{\"EmployeeId\":17,\"TaskId\":53},{\"EmployeeId\":9,\"TaskId\":54},{\"EmployeeId\":15,\"TaskId\":54},{\"EmployeeId\":17,\"TaskId\":54},{\"EmployeeId\":22,\"TaskId\":54},{\"EmployeeId\":11,\"TaskId\":55},{\"EmployeeId\":14,\"TaskId\":55},{\"EmployeeId\":4,\"TaskId\":56},{\"EmployeeId\":8,\"TaskId\":56},{\"EmployeeId\":13,\"TaskId\":56},{\"EmployeeId\":14,\"TaskId\":56},{\"EmployeeId\":16,\"TaskId\":56},{\"EmployeeId\":2,\"TaskId\":57},{\"EmployeeId\":20,\"TaskId\":57},{\"EmployeeId\":5,\"TaskId\":58},{\"EmployeeId\":18,\"TaskId\":58},{\"EmployeeId\":2,\"TaskId\":59},{\"EmployeeId\":12,\"TaskId\":59},{\"EmployeeId\":14,\"TaskId\":59},{\"EmployeeId\":15,\"TaskId\":59},{\"EmployeeId\":4,\"TaskId\":60},{\"EmployeeId\":2,\"TaskId\":61},{\"EmployeeId\":8,\"TaskId\":62},{\"EmployeeId\":13,\"TaskId\":62},{\"EmployeeId\":24,\"TaskId\":62}]}";

        var datasets = JsonConvert.DeserializeObject<Dictionary<string, IEnumerable<JObject>>>(datasetsJson);

        foreach (var dataset in datasets)
        {
            var entityType = GetType(dataset.Key);
            var entities = dataset.Value
                .Select(j => j.ToObject(entityType))
                .ToArray();

            context.AddRange(entities);
        }

        context.SaveChanges();
    }

    private static Type GetType(string modelName)
    {
        var modelType = CurrentAssembly
            .GetTypes()
            .FirstOrDefault(t => t.Name == modelName);

        Assert.IsNotNull(modelType, $"{modelName} model not found!");

        return modelType;
    }

    private static IServiceProvider ConfigureServices<TContext>(string databaseName)
        where TContext : DbContext
    {
        var services = ConfigureDbContext<TContext>(databaseName);

        var context = services.GetService<TContext>();

        try
        {
            context.Model.GetEntityTypes();
        }
        catch (InvalidOperationException ex) when (ex.Source == "Microsoft.EntityFrameworkCore.Proxies")
        {
            services = ConfigureDbContext<TContext>(databaseName, useLazyLoading: true);
        }

        return services;
    }

    private static IServiceProvider ConfigureDbContext<TContext>(string databaseName, bool useLazyLoading = false)
        where TContext : DbContext
    {
        var services = new ServiceCollection()
           .AddDbContext<TContext>(t => t
           .UseInMemoryDatabase(Guid.NewGuid().ToString())
           );

        var serviceProvider = services.BuildServiceProvider();
        return serviceProvider;
    }
}