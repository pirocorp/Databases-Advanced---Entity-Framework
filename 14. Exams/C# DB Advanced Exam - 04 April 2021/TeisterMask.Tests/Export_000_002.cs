//Resharper disable InconsistentNaming, CheckNamespace

using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Xml.Linq;
using AutoMapper;
using AutoMapper.Configuration;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.DependencyInjection;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using NUnit.Framework;
using TeisterMask;
using TeisterMask.Data;
using TeisterMask.DataProcessor;

[TestFixture] //XML!!!
public class Export_000_002
{
    private IServiceProvider serviceProvider;
    private static Assembly CurrentAssembly;

    [SetUp]
    public void Setup()
    {
        CurrentAssembly = typeof(StartUp).Assembly;

	Mapper.Reset();

        Mapper.Initialize(cfg => cfg.AddProfile(GetType("TeisterMaskProfile")));

        this.serviceProvider = ConfigureServices<TeisterMaskContext>("TeisterMask");
    }

    [Test]
    public void ExportProjectWithTheirTasksZeroTest()
    {
        var context = serviceProvider.GetService<TeisterMaskContext>();

        SeedDatabase(context);

        var actualXml = Serializer.ExportProjectWithTheirTasks(context);
        var actualOutput = XDocument.Parse(actualXml);

        string expectedXml =
            "<Projects><Project TasksCount=\"9\"><ProjectName>First Trust Senior Loan Fund ETF</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Cyrtandra</Name><Label>Priority</Label></Task><Task><Name>Deadnettle</Name><Label>Priority</Label></Task><Task><Name>Dracontium</Name><Label>JavaAdvanced</Label></Task><Task><Name>Hiiaka</Name><Label>JavaAdvanced</Label></Task><Task><Name>Hummock Honeymyrtle</Name><Label>Priority</Label></Task><Task><Name>Ravenel's Rosette Grass</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Rush</Name><Label>Priority</Label></Task><Task><Name>Sharpleaf Penstemon</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Torrey's Mountainmint</Name><Label>EntityFramework</Label></Task></Tasks></Project><Project TasksCount=\"9\"><ProjectName>Hyster-Yale</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Broadleaf</Name><Label>JavaAdvanced</Label></Task><Task><Name>Cornflag</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Crandall</Name><Label>Priority</Label></Task><Task><Name>Debeque</Name><Label>JavaAdvanced</Label></Task><Task><Name>Guadalupe</Name><Label>JavaAdvanced</Label></Task><Task><Name>Guadeloupe</Name><Label>JavaAdvanced</Label></Task><Task><Name>Longbract Pohlia Moss</Name><Label>EntityFramework</Label></Task><Task><Name>Meyen's Sedge</Name><Label>EntityFramework</Label></Task><Task><Name>Pacific</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"6\"><ProjectName>Public Storage</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Arctic Raspberry</Name><Label>EntityFramework</Label></Task><Task><Name>Bullfrog Mountain Pea</Name><Label>JavaAdvanced</Label></Task><Task><Name>Clustered Sawwort</Name><Label>Priority</Label></Task><Task><Name>Fir Clubmoss</Name><Label>EntityFramework</Label></Task><Task><Name>Indian Canyon Fleabane</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Oregon Figwort</Name><Label>CSharpAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"5\"><ProjectName>Greenbrier Companies</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Awned Mountainmint</Name><Label>JavaAdvanced</Label></Task><Task><Name>Calophyllum</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Pearson's</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Redvein Dock</Name><Label>Priority</Label></Task><Task><Name>Rio Abajo Maiden Fern</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"5\"><ProjectName>SCYNEXIS, Inc.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>American Star-thistle</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Davis</Name><Label>Hibernate</Label></Task><Task><Name>Glochidion</Name><Label>JavaAdvanced</Label></Task><Task><Name>Silver Mock Orange</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Yellow Wildrye</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"4\"><ProjectName>SS S.A.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Ale</Name><Label>JavaAdvanced</Label></Task><Task><Name>Drummond's Cinquefoil</Name><Label>JavaAdvanced</Label></Task><Task><Name>Geyer's Oniongrass</Name><Label>Hibernate</Label></Task><Task><Name>Wheat</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"3\"><ProjectName>American National Bankshares, Inc.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Astrothelium Lichen</Name><Label>EntityFramework</Label></Task><Task><Name>Loeskypnum Moss</Name><Label>JavaAdvanced</Label></Task><Task><Name>Meyen's Flatsedge</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"3\"><ProjectName>Brandywine</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Cypress Panicgrass</Name><Label>EntityFramework</Label></Task><Task><Name>Gairdner's Yampah</Name><Label>Hibernate</Label></Task><Task><Name>s-tail</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"3\"><ProjectName>Key Energy Services, Inc.</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Columbian</Name><Label>Hibernate</Label></Task><Task><Name>Roundleaf Leather-root</Name><Label>Priority</Label></Task><Task><Name>Uvero De Monte</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"3\"><ProjectName>Vical</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Korean Cherry</Name><Label>Hibernate</Label></Task><Task><Name>Longlobe Four O'clock</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Shrubby False</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>Alamos Gold Inc.</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Bicolored Spleenwort</Name><Label>CSharpAdvanced</Label></Task><Task><Name>Comfortroot</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>Blackrock MuniHoldings</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Saber Bogmat</Name><Label>Priority</Label></Task><Task><Name>Yellow Troutlily</Name><Label>JavaAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>Boston</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Sturdy Bulrush</Name><Label>EntityFramework</Label></Task><Task><Name>White Jungleflame</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>Cellectis S.A.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Moleplant</Name><Label>JavaAdvanced</Label></Task><Task><Name>Yellowstone Milkvetch</Name><Label>CSharpAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>Land Systemttttttttttttttttttttttttttt</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Blueeyed</Name><Label>JavaAdvanced</Label></Task><Task><Name>Northland</Name><Label>CSharpAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>TESARO, Inc.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Beautybush</Name><Label>EntityFramework</Label></Task><Task><Name>Mountain Naupaka</Name><Label>EntityFramework</Label></Task></Tasks></Project><Project TasksCount=\"2\"><ProjectName>VivoPower PLC</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Digitgrass</Name><Label>EntityFramework</Label></Task><Task><Name>Rock Whitefeather</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>America</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Fineleaf</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>Atlas Air</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Smooth Babybonnets</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>Caleres, Inc.</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Plains Flax</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>China Lending Corporation</ProjectName><HasEndDate>No</HasEndDate><Tasks><Task><Name>Spreading Sandwort</Name><Label>Hibernate</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>Cypress Energy</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Wood Wakerobin</Name><Label>JavaAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>First22</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Clammy</Name><Label>JavaAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>Interpace 22.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Globe Ball Lichen</Name><Label>CSharpAdvanced</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>National Beverage Corp.</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Carrotwood</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>Postman</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Wetslope Buttercup</Name><Label>EntityFramework</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>Two River Bancorp</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>Thinleaved</Name><Label>Priority</Label></Task></Tasks></Project><Project TasksCount=\"1\"><ProjectName>U.S. Bancorp</ProjectName><HasEndDate>Yes</HasEndDate><Tasks><Task><Name>San Joaquin Dodder</Name><Label>JavaAdvanced</Label></Task></Tasks></Project></Projects>";

        var expectedOutput = XDocument.Parse(expectedXml);

        var expectedOutputXml = expectedOutput.ToString(SaveOptions.DisableFormatting);
        var actualOutputXml = actualOutput.ToString(SaveOptions.DisableFormatting);
        ;
        Assert.That(actualOutputXml, Is.EqualTo(expectedOutputXml).NoClip,
            $"{nameof(Serializer.ExportProjectWithTheirTasks)} output is incorrect!");
    }

    private static void SeedDatabase(TeisterMaskContext context)
    {
        var datasetsJson =
            "{\"Project\":[{\"Id\":1,\"Name\":\"America\",\"OpenDate\":\"2018-01-19T00:06:00\",\"DueDate\":\"2019-01-26T00:10:00\"},{\"Id\":2,\"Name\":\"New Oriental\",\"OpenDate\":\"2018-01-27T00:01:00\",\"DueDate\":\"2019-01-25T00:07:00\"},{\"Id\":3,\"Name\":\"Two River Bancorp\",\"OpenDate\":\"2018-01-04T00:04:00\",\"DueDate\":\"2019-01-26T00:07:00\"},{\"Id\":4,\"Name\":\"Perceptron, Inc.\",\"OpenDate\":\"2018-01-20T00:02:00\",\"DueDate\":\"2018-01-15T00:12:00\"},{\"Id\":5,\"Name\":\"National Beverage Corp.\",\"OpenDate\":\"2018-01-16T00:03:00\",\"DueDate\":\"2019-01-28T00:03:00\"},{\"Id\":6,\"Name\":\"China Lending Corporation\",\"OpenDate\":\"2018-01-02T00:02:00\",\"DueDate\":null},{\"Id\":7,\"Name\":\"American National Bankshares, Inc.\",\"OpenDate\":\"2018-01-14T00:08:00\",\"DueDate\":\"2019-01-11T00:02:00\"},{\"Id\":8,\"Name\":\"Sumitomo Mitsui\",\"OpenDate\":\"2018-01-04T00:01:00\",\"DueDate\":\"2018-01-28T00:11:00\"},{\"Id\":9,\"Name\":\"Public Storage\",\"OpenDate\":\"2018-01-02T00:07:00\",\"DueDate\":null},{\"Id\":10,\"Name\":\"Cellectis S.A.\",\"OpenDate\":\"2018-01-18T00:03:00\",\"DueDate\":\"2019-01-15T00:02:00\"},{\"Id\":11,\"Name\":\"SS S.A.\",\"OpenDate\":\"2018-01-19T00:09:00\",\"DueDate\":\"2019-01-21T00:04:00\"},{\"Id\":12,\"Name\":\"Key Energy Services, Inc.\",\"OpenDate\":\"2018-01-16T00:08:00\",\"DueDate\":null},{\"Id\":13,\"Name\":\"Alamos Gold Inc.\",\"OpenDate\":\"2018-01-01T00:01:00\",\"DueDate\":null},{\"Id\":14,\"Name\":\"Atlas Air\",\"OpenDate\":\"2018-01-23T00:10:00\",\"DueDate\":\"2019-01-12T00:01:00\"},{\"Id\":15,\"Name\":\"U.S. Bancorp\",\"OpenDate\":\"2018-01-22T00:01:00\",\"DueDate\":\"2019-01-14T00:07:00\"},{\"Id\":16,\"Name\":\"Medley Capital Corporation\",\"OpenDate\":\"2018-01-14T00:02:00\",\"DueDate\":\"2018-01-25T00:12:00\"},{\"Id\":17,\"Name\":\"Magna Inc.\",\"OpenDate\":\"2018-01-28T00:06:00\",\"DueDate\":\"2019-01-03T00:02:00\"},{\"Id\":18,\"Name\":\"Caleres, Inc.\",\"OpenDate\":\"2018-01-06T00:07:00\",\"DueDate\":null},{\"Id\":19,\"Name\":\"First Trust Senior Loan Fund ETF\",\"OpenDate\":\"2018-01-02T00:04:00\",\"DueDate\":\"2019-01-21T00:01:00\"},{\"Id\":20,\"Name\":\"Tekla Life\",\"OpenDate\":\"2018-01-11T00:10:00\",\"DueDate\":\"2018-01-08T00:12:00\"},{\"Id\":21,\"Name\":\"TearLab Corporation\",\"OpenDate\":\"2018-01-08T00:03:00\",\"DueDate\":\"2019-01-05T00:05:00\"},{\"Id\":22,\"Name\":\"SCYNEXIS, Inc.\",\"OpenDate\":\"2018-01-18T00:07:00\",\"DueDate\":\"2019-01-26T00:07:00\"},{\"Id\":23,\"Name\":\"Hyster-Yale\",\"OpenDate\":\"2018-01-05T00:02:00\",\"DueDate\":null},{\"Id\":24,\"Name\":\"Vical\",\"OpenDate\":\"2018-01-19T00:08:00\",\"DueDate\":\"2019-01-14T00:02:00\"},{\"Id\":25,\"Name\":\"PPL Corporation\",\"OpenDate\":\"2018-01-30T00:09:00\",\"DueDate\":null},{\"Id\":26,\"Name\":\"Land Systemttttttttttttttttttttttttttt\",\"OpenDate\":\"2018-01-16T00:03:00\",\"DueDate\":null},{\"Id\":27,\"Name\":\"Cypress Energy\",\"OpenDate\":\"2018-01-22T00:07:00\",\"DueDate\":\"2019-01-13T00:04:00\"},{\"Id\":28,\"Name\":\"Boston\",\"OpenDate\":\"2018-01-06T00:03:00\",\"DueDate\":\"2019-01-26T00:02:00\"},{\"Id\":29,\"Name\":\"TESARO, Inc.\",\"OpenDate\":\"2018-01-20T00:06:00\",\"DueDate\":\"2019-01-13T00:05:00\"},{\"Id\":30,\"Name\":\"Net 1 UEPS Technologies, Inc.\",\"OpenDate\":\"2018-01-20T00:01:00\",\"DueDate\":\"2019-01-02T00:04:00\"},{\"Id\":31,\"Name\":\"Interpace 22.\",\"OpenDate\":\"2018-01-20T00:10:00\",\"DueDate\":\"2019-01-19T00:01:00\"},{\"Id\":32,\"Name\":\"L Brands, Inc.\",\"OpenDate\":\"2018-01-24T00:10:00\",\"DueDate\":\"2019-01-14T00:03:00\"},{\"Id\":33,\"Name\":\"Postman\",\"OpenDate\":\"2018-01-01T00:11:00\",\"DueDate\":\"2019-01-10T00:06:00\"},{\"Id\":34,\"Name\":\"VivoPower PLC\",\"OpenDate\":\"2018-01-02T00:01:00\",\"DueDate\":\"2019-01-30T00:08:00\"},{\"Id\":35,\"Name\":\"Arbor Trust\",\"OpenDate\":\"2018-01-01T00:09:00\",\"DueDate\":\"2019-01-05T00:09:00\"},{\"Id\":36,\"Name\":\"Greenbrier Companies\",\"OpenDate\":\"2018-01-02T00:02:00\",\"DueDate\":\"2019-01-23T00:05:00\"},{\"Id\":37,\"Name\":\"BBVA Banco Frances S.A.\",\"OpenDate\":\"2018-01-04T00:01:00\",\"DueDate\":\"2018-01-11T00:12:00\"},{\"Id\":38,\"Name\":\"First22\",\"OpenDate\":\"2018-01-22T00:05:00\",\"DueDate\":\"2019-01-23T00:01:00\"},{\"Id\":39,\"Name\":\"Brandywine\",\"OpenDate\":\"2018-01-15T00:10:00\",\"DueDate\":\"2019-01-21T00:07:00\"},{\"Id\":40,\"Name\":\"America Corporation\",\"OpenDate\":\"2018-01-16T00:09:00\",\"DueDate\":\"2019-01-02T00:03:00\"},{\"Id\":41,\"Name\":\"Blackrock MuniHoldings\",\"OpenDate\":\"2018-01-09T00:06:00\",\"DueDate\":\"2019-01-13T00:03:00\"},{\"Id\":42,\"Name\":\"USANA Health Sciences, Inc.\",\"OpenDate\":\"2018-01-28T00:05:00\",\"DueDate\":\"2019-01-04T00:11:00\"}],\"Task\":[{\"Id\":1,\"Name\":\"Fineleaf\",\"OpenDate\":\"2018-01-31T00:08:00\",\"DueDate\":\"2019-01-18T00:04:00\",\"ExecutionType\":0,\"LabelType\":4,\"ProjectId\":1},{\"Id\":2,\"Name\":\"Loeskypnum Moss\",\"OpenDate\":\"2018-01-28T00:07:00\",\"DueDate\":\"2018-01-20T00:11:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":7},{\"Id\":3,\"Name\":\"Astrothelium Lichen\",\"OpenDate\":\"2018-01-19T00:10:00\",\"DueDate\":\"2019-01-02T00:06:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":7},{\"Id\":4,\"Name\":\"Meyen's Flatsedge\",\"OpenDate\":\"2018-01-23T00:06:00\",\"DueDate\":\"2019-01-06T00:08:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":7},{\"Id\":5,\"Name\":\"Spreading Sandwort\",\"OpenDate\":\"2018-01-19T00:02:00\",\"DueDate\":\"2018-01-20T00:11:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":6},{\"Id\":6,\"Name\":\"Carrotwood\",\"OpenDate\":\"2018-01-23T00:07:00\",\"DueDate\":\"2019-01-11T00:03:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":5},{\"Id\":7,\"Name\":\"Thinleaved\",\"OpenDate\":\"2018-01-11T00:07:00\",\"DueDate\":\"2019-01-08T00:08:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":3},{\"Id\":8,\"Name\":\"Cyrtandra\",\"OpenDate\":\"2018-01-04T00:08:00\",\"DueDate\":\"2018-01-14T00:11:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":19},{\"Id\":9,\"Name\":\"Sharpleaf Penstemon\",\"OpenDate\":\"2018-01-22T00:04:00\",\"DueDate\":\"2019-01-05T00:05:00\",\"ExecutionType\":3,\"LabelType\":1,\"ProjectId\":19},{\"Id\":10,\"Name\":\"Rush\",\"OpenDate\":\"2018-01-07T00:09:00\",\"DueDate\":\"2019-01-19T00:09:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":19},{\"Id\":11,\"Name\":\"Hiiaka\",\"OpenDate\":\"2018-01-24T00:08:00\",\"DueDate\":\"2019-01-15T00:09:00\",\"ExecutionType\":2,\"LabelType\":2,\"ProjectId\":19},{\"Id\":12,\"Name\":\"Hummock Honeymyrtle\",\"OpenDate\":\"2018-01-16T00:08:00\",\"DueDate\":\"2019-01-18T00:02:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":19},{\"Id\":13,\"Name\":\"Torrey's Mountainmint\",\"OpenDate\":\"2018-01-30T00:05:00\",\"DueDate\":\"2019-01-14T00:08:00\",\"ExecutionType\":1,\"LabelType\":3,\"ProjectId\":19},{\"Id\":14,\"Name\":\"Dracontium\",\"OpenDate\":\"2018-01-13T00:01:00\",\"DueDate\":\"2019-01-17T00:07:00\",\"ExecutionType\":2,\"LabelType\":2,\"ProjectId\":19},{\"Id\":15,\"Name\":\"Deadnettle\",\"OpenDate\":\"2018-01-05T00:08:00\",\"DueDate\":\"2019-01-06T00:05:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":19},{\"Id\":16,\"Name\":\"Ravenel's Rosette Grass\",\"OpenDate\":\"2018-01-07T00:04:00\",\"DueDate\":\"2019-01-07T00:07:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":19},{\"Id\":17,\"Name\":\"Fir Clubmoss\",\"OpenDate\":\"2018-01-15T00:09:00\",\"DueDate\":\"2019-01-08T00:07:00\",\"ExecutionType\":3,\"LabelType\":3,\"ProjectId\":9},{\"Id\":18,\"Name\":\"Yellow Wildrye\",\"OpenDate\":\"2018-01-26T00:07:00\",\"DueDate\":\"2018-01-12T00:12:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":22},{\"Id\":19,\"Name\":\"Oregon Figwort\",\"OpenDate\":\"2018-01-12T00:05:00\",\"DueDate\":\"2019-01-06T00:09:00\",\"ExecutionType\":3,\"LabelType\":1,\"ProjectId\":9},{\"Id\":20,\"Name\":\"Indian Canyon Fleabane\",\"OpenDate\":\"2018-01-25T00:03:00\",\"DueDate\":\"2019-01-05T00:01:00\",\"ExecutionType\":3,\"LabelType\":1,\"ProjectId\":9},{\"Id\":21,\"Name\":\"San Joaquin Dodder\",\"OpenDate\":\"2018-01-30T00:08:00\",\"DueDate\":\"2019-01-02T00:11:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":15},{\"Id\":22,\"Name\":\"Smooth Babybonnets\",\"OpenDate\":\"2018-01-27T00:01:00\",\"DueDate\":\"2019-01-10T00:02:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":14},{\"Id\":23,\"Name\":\"Bicolored Spleenwort\",\"OpenDate\":\"2018-01-24T00:05:00\",\"DueDate\":\"2019-01-02T00:07:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":13},{\"Id\":24,\"Name\":\"Comfortroot\",\"OpenDate\":\"2018-01-14T00:07:00\",\"DueDate\":\"2019-01-10T00:06:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":13},{\"Id\":25,\"Name\":\"Columbian\",\"OpenDate\":\"2018-01-24T00:10:00\",\"DueDate\":\"2019-01-20T00:10:00\",\"ExecutionType\":2,\"LabelType\":4,\"ProjectId\":12},{\"Id\":26,\"Name\":\"Roundleaf Leather-root\",\"OpenDate\":\"2018-01-28T00:08:00\",\"DueDate\":\"2019-01-11T00:04:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":12},{\"Id\":27,\"Name\":\"Uvero De Monte\",\"OpenDate\":\"2018-01-19T00:06:00\",\"DueDate\":\"2019-01-14T00:06:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":12},{\"Id\":28,\"Name\":\"Ale\",\"OpenDate\":\"2018-01-30T00:10:00\",\"DueDate\":\"2019-01-16T00:09:00\",\"ExecutionType\":2,\"LabelType\":2,\"ProjectId\":11},{\"Id\":29,\"Name\":\"Geyer's Oniongrass\",\"OpenDate\":\"2018-01-28T00:09:00\",\"DueDate\":\"2019-01-13T00:09:00\",\"ExecutionType\":3,\"LabelType\":4,\"ProjectId\":11},{\"Id\":30,\"Name\":\"Drummond's Cinquefoil\",\"OpenDate\":\"2018-01-24T00:01:00\",\"DueDate\":\"2019-01-08T00:06:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":11},{\"Id\":31,\"Name\":\"Wheat\",\"OpenDate\":\"2018-01-27T00:07:00\",\"DueDate\":\"2019-01-19T00:05:00\",\"ExecutionType\":1,\"LabelType\":4,\"ProjectId\":11},{\"Id\":32,\"Name\":\"Yellowstone Milkvetch\",\"OpenDate\":\"2018-01-23T00:08:00\",\"DueDate\":\"2019-01-13T00:09:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":10},{\"Id\":33,\"Name\":\"Moleplant\",\"OpenDate\":\"2018-01-26T00:01:00\",\"DueDate\":\"2019-01-12T00:02:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":10},{\"Id\":34,\"Name\":\"Clustered Sawwort\",\"OpenDate\":\"2018-01-21T00:07:00\",\"DueDate\":\"2018-01-09T00:12:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":9},{\"Id\":35,\"Name\":\"Arctic Raspberry\",\"OpenDate\":\"2018-01-23T00:06:00\",\"DueDate\":\"2019-01-29T00:01:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":9},{\"Id\":36,\"Name\":\"Bullfrog Mountain Pea\",\"OpenDate\":\"2018-01-18T00:01:00\",\"DueDate\":\"2018-01-10T00:12:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":9},{\"Id\":37,\"Name\":\"Plains Flax\",\"OpenDate\":\"2018-01-07T00:02:00\",\"DueDate\":\"2018-01-22T00:11:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":18},{\"Id\":38,\"Name\":\"Glochidion\",\"OpenDate\":\"2018-01-23T00:08:00\",\"DueDate\":\"2019-01-05T00:11:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":22},{\"Id\":39,\"Name\":\"American Star-thistle\",\"OpenDate\":\"2018-01-21T00:09:00\",\"DueDate\":\"2018-01-29T00:11:00\",\"ExecutionType\":0,\"LabelType\":1,\"ProjectId\":22},{\"Id\":40,\"Name\":\"Wood Wakerobin\",\"OpenDate\":\"2018-01-25T00:04:00\",\"DueDate\":\"2019-01-08T00:02:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":27},{\"Id\":41,\"Name\":\"Northland\",\"OpenDate\":\"2018-01-31T00:07:00\",\"DueDate\":\"2019-01-06T00:04:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":26},{\"Id\":42,\"Name\":\"Blueeyed\",\"OpenDate\":\"2018-01-22T00:10:00\",\"DueDate\":\"2019-01-25T00:06:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":26},{\"Id\":43,\"Name\":\"Shrubby False\",\"OpenDate\":\"2018-01-25T00:09:00\",\"DueDate\":\"2019-01-04T00:09:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":24},{\"Id\":44,\"Name\":\"Korean Cherry\",\"OpenDate\":\"2018-01-24T00:10:00\",\"DueDate\":\"2019-01-06T00:05:00\",\"ExecutionType\":0,\"LabelType\":4,\"ProjectId\":24},{\"Id\":45,\"Name\":\"Longlobe Four O'clock\",\"OpenDate\":\"2018-01-24T00:04:00\",\"DueDate\":\"2019-01-03T00:05:00\",\"ExecutionType\":3,\"LabelType\":1,\"ProjectId\":24},{\"Id\":46,\"Name\":\"Meyen's Sedge\",\"OpenDate\":\"2018-01-09T00:10:00\",\"DueDate\":\"2019-01-05T00:05:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":23},{\"Id\":47,\"Name\":\"Guadeloupe\",\"OpenDate\":\"2018-01-14T00:02:00\",\"DueDate\":\"2019-01-09T00:02:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":23},{\"Id\":48,\"Name\":\"Longbract Pohlia Moss\",\"OpenDate\":\"2018-01-13T00:09:00\",\"DueDate\":\"2019-01-29T00:03:00\",\"ExecutionType\":2,\"LabelType\":3,\"ProjectId\":23},{\"Id\":49,\"Name\":\"Crandall\",\"OpenDate\":\"2018-01-12T00:03:00\",\"DueDate\":\"2019-01-21T00:02:00\",\"ExecutionType\":2,\"LabelType\":0,\"ProjectId\":23},{\"Id\":50,\"Name\":\"Guadalupe\",\"OpenDate\":\"2018-01-29T00:09:00\",\"DueDate\":\"2018-01-23T00:12:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":23},{\"Id\":51,\"Name\":\"Pacific\",\"OpenDate\":\"2018-01-14T00:05:00\",\"DueDate\":\"2019-01-05T00:07:00\",\"ExecutionType\":3,\"LabelType\":0,\"ProjectId\":23},{\"Id\":52,\"Name\":\"Debeque\",\"OpenDate\":\"2018-01-17T00:10:00\",\"DueDate\":\"2019-01-25T00:01:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":23},{\"Id\":53,\"Name\":\"Cornflag\",\"OpenDate\":\"2018-01-27T00:09:00\",\"DueDate\":\"2019-01-25T00:09:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":23},{\"Id\":54,\"Name\":\"Broadleaf\",\"OpenDate\":\"2018-01-21T00:03:00\",\"DueDate\":\"2018-01-18T00:12:00\",\"ExecutionType\":0,\"LabelType\":2,\"ProjectId\":23},{\"Id\":55,\"Name\":\"Sturdy Bulrush\",\"OpenDate\":\"2018-01-25T00:10:00\",\"DueDate\":\"2018-01-20T00:11:00\",\"ExecutionType\":1,\"LabelType\":3,\"ProjectId\":28},{\"Id\":56,\"Name\":\"Silver Mock Orange\",\"OpenDate\":\"2018-01-21T00:09:00\",\"DueDate\":\"2019-01-22T00:09:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":22},{\"Id\":57,\"Name\":\"White Jungleflame\",\"OpenDate\":\"2018-01-10T00:10:00\",\"DueDate\":\"2019-01-11T00:02:00\",\"ExecutionType\":3,\"LabelType\":4,\"ProjectId\":28},{\"Id\":58,\"Name\":\"Mountain Naupaka\",\"OpenDate\":\"2018-01-29T00:03:00\",\"DueDate\":\"2019-01-03T00:05:00\",\"ExecutionType\":1,\"LabelType\":3,\"ProjectId\":29},{\"Id\":59,\"Name\":\"Davis\",\"OpenDate\":\"2018-01-25T00:07:00\",\"DueDate\":\"2019-01-01T00:11:00\",\"ExecutionType\":1,\"LabelType\":4,\"ProjectId\":22},{\"Id\":60,\"Name\":\"Cypress Panicgrass\",\"OpenDate\":\"2018-01-19T00:10:00\",\"DueDate\":\"2018-01-17T00:11:00\",\"ExecutionType\":2,\"LabelType\":3,\"ProjectId\":39},{\"Id\":61,\"Name\":\"Gairdner's Yampah\",\"OpenDate\":\"2018-01-16T00:05:00\",\"DueDate\":\"2019-01-07T00:04:00\",\"ExecutionType\":1,\"LabelType\":4,\"ProjectId\":39},{\"Id\":62,\"Name\":\"s-tail\",\"OpenDate\":\"2018-01-18T00:10:00\",\"DueDate\":\"2019-01-15T00:10:00\",\"ExecutionType\":0,\"LabelType\":4,\"ProjectId\":39},{\"Id\":63,\"Name\":\"Clammy\",\"OpenDate\":\"2018-01-30T00:04:00\",\"DueDate\":\"2019-01-03T00:01:00\",\"ExecutionType\":1,\"LabelType\":2,\"ProjectId\":38},{\"Id\":64,\"Name\":\"Rio Abajo Maiden Fern\",\"OpenDate\":\"2018-01-16T00:02:00\",\"DueDate\":\"2019-01-20T00:07:00\",\"ExecutionType\":1,\"LabelType\":0,\"ProjectId\":36},{\"Id\":65,\"Name\":\"Awned Mountainmint\",\"OpenDate\":\"2018-01-19T00:10:00\",\"DueDate\":\"2019-01-17T00:04:00\",\"ExecutionType\":3,\"LabelType\":2,\"ProjectId\":36},{\"Id\":66,\"Name\":\"Redvein Dock\",\"OpenDate\":\"2018-01-11T00:10:00\",\"DueDate\":\"2019-01-10T00:09:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":36},{\"Id\":67,\"Name\":\"Calophyllum\",\"OpenDate\":\"2018-01-09T00:10:00\",\"DueDate\":\"2018-01-15T00:11:00\",\"ExecutionType\":2,\"LabelType\":1,\"ProjectId\":36},{\"Id\":68,\"Name\":\"Pearson's\",\"OpenDate\":\"2018-01-07T00:03:00\",\"DueDate\":\"2019-01-21T00:05:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":36},{\"Id\":69,\"Name\":\"Rock Whitefeather\",\"OpenDate\":\"2018-01-23T00:01:00\",\"DueDate\":\"2019-01-24T00:08:00\",\"ExecutionType\":1,\"LabelType\":4,\"ProjectId\":34},{\"Id\":70,\"Name\":\"Digitgrass\",\"OpenDate\":\"2018-01-02T00:06:00\",\"DueDate\":\"2019-01-18T00:05:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":34},{\"Id\":71,\"Name\":\"Wetslope Buttercup\",\"OpenDate\":\"2018-01-07T00:03:00\",\"DueDate\":\"2018-01-21T00:11:00\",\"ExecutionType\":2,\"LabelType\":3,\"ProjectId\":33},{\"Id\":72,\"Name\":\"Yellow Troutlily\",\"OpenDate\":\"2018-01-27T00:07:00\",\"DueDate\":\"2019-01-05T00:09:00\",\"ExecutionType\":2,\"LabelType\":2,\"ProjectId\":41},{\"Id\":73,\"Name\":\"Saber Bogmat\",\"OpenDate\":\"2018-01-16T00:08:00\",\"DueDate\":\"2019-01-12T00:03:00\",\"ExecutionType\":0,\"LabelType\":0,\"ProjectId\":41},{\"Id\":74,\"Name\":\"Beautybush\",\"OpenDate\":\"2018-01-24T00:02:00\",\"DueDate\":\"2019-01-13T00:02:00\",\"ExecutionType\":0,\"LabelType\":3,\"ProjectId\":29},{\"Id\":75,\"Name\":\"Globe Ball Lichen\",\"OpenDate\":\"2018-01-23T00:07:00\",\"DueDate\":\"2018-01-18T00:11:00\",\"ExecutionType\":1,\"LabelType\":1,\"ProjectId\":31}],\"Employee\":[{\"Id\":1,\"Username\":\"jstanett0\",\"Email\":\"kknapper0@opera.com\",\"Phone\":\"819-699-1096\"},{\"Id\":2,\"Username\":\"pclaffeyq\",\"Email\":\"cussherq@tumblr.com\",\"Phone\":\"225-876-9150\"},{\"Id\":3,\"Username\":\"jbehlingp\",\"Email\":\"crogetp@imdb.com\",\"Phone\":\"470-834-7902\"},{\"Id\":4,\"Username\":\"ocoolsono\",\"Email\":\"dchadbourneo@com.com\",\"Phone\":\"105-464-2474\"},{\"Id\":5,\"Username\":\"lmarquissn\",\"Email\":\"graglessn@berkeley.edu\",\"Phone\":\"239-404-5576\"},{\"Id\":6,\"Username\":\"mobispom\",\"Email\":\"smcdonoghm@jimdo.com\",\"Phone\":\"589-982-5040\"},{\"Id\":7,\"Username\":\"mkyncll\",\"Email\":\"jbarbierl@imdb.com\",\"Phone\":\"184-104-0626\"},{\"Id\":8,\"Username\":\"emccarryk\",\"Email\":\"wgrindrodk@mysql.com\",\"Phone\":\"959-210-4953\"},{\"Id\":9,\"Username\":\"ehawtoni\",\"Email\":\"prousselli@artisteer.com\",\"Phone\":\"113-391-9570\"},{\"Id\":10,\"Username\":\"gkeemsh\",\"Email\":\"qcaulfieldh@dropbox.com\",\"Phone\":\"904-722-6709\"},{\"Id\":11,\"Username\":\"sthynneg\",\"Email\":\"rderocheg@techcrunch.com\",\"Phone\":\"194-364-8234\"},{\"Id\":12,\"Username\":\"bbetoniar\",\"Email\":\"crosternr@bloglines.com\",\"Phone\":\"512-373-2485\"},{\"Id\":13,\"Username\":\"tridolfif\",\"Email\":\"eterrazzof@slideshare.net\",\"Phone\":\"262-575-8196\"},{\"Id\":14,\"Username\":\"btorrejond\",\"Email\":\"nskerrittd@mashable.com\",\"Phone\":\"405-758-1588\"},{\"Id\":15,\"Username\":\"olathleiffurec\",\"Email\":\"aspohrmannc@ezinearticles.com\",\"Phone\":\"782-166-4860\"},{\"Id\":16,\"Username\":\"pnicolsonb\",\"Email\":\"dbeinckenb@earthlink.net\",\"Phone\":\"349-526-0430\"},{\"Id\":17,\"Username\":\"mbarendtsena\",\"Email\":\"srountreea@google.it\",\"Phone\":\"567-348-2054\"},{\"Id\":18,\"Username\":\"qfilkin7\",\"Email\":\"mhanselmann7@soundcloud.com\",\"Phone\":\"678-790-6495\"},{\"Id\":19,\"Username\":\"codaly6\",\"Email\":\"rhaglington6@hibu.com\",\"Phone\":\"305-464-1823\"},{\"Id\":20,\"Username\":\"dnapton4\",\"Email\":\"asprey4@businessinsider.com\",\"Phone\":\"235-815-6395\"},{\"Id\":21,\"Username\":\"mdilucia3\",\"Email\":\"nangus3@about.com\",\"Phone\":\"973-545-0173\"},{\"Id\":22,\"Username\":\"cmartinho2\",\"Email\":\"kgosse2@aol.com\",\"Phone\":\"958-128-8777\"},{\"Id\":23,\"Username\":\"mmcellen1\",\"Email\":\"emorten1@ucla.edu\",\"Phone\":\"806-478-7549\"},{\"Id\":24,\"Username\":\"mdivere\",\"Email\":\"shawarde@squarespace.com\",\"Phone\":\"888-104-4239\"},{\"Id\":25,\"Username\":\"hgreenhaughs\",\"Email\":\"ebirkbys@bandcamp.com\",\"Phone\":\"622-909-9951\"}],\"EmployeeTask\":[{\"EmployeeId\":16,\"TaskId\":1},{\"EmployeeId\":23,\"TaskId\":1},{\"EmployeeId\":15,\"TaskId\":2},{\"EmployeeId\":23,\"TaskId\":2},{\"EmployeeId\":6,\"TaskId\":3},{\"EmployeeId\":10,\"TaskId\":3},{\"EmployeeId\":24,\"TaskId\":3},{\"EmployeeId\":2,\"TaskId\":4},{\"EmployeeId\":4,\"TaskId\":4},{\"EmployeeId\":19,\"TaskId\":4},{\"EmployeeId\":23,\"TaskId\":4},{\"EmployeeId\":12,\"TaskId\":5},{\"EmployeeId\":19,\"TaskId\":5},{\"EmployeeId\":23,\"TaskId\":5},{\"EmployeeId\":6,\"TaskId\":6},{\"EmployeeId\":11,\"TaskId\":6},{\"EmployeeId\":23,\"TaskId\":6},{\"EmployeeId\":4,\"TaskId\":7},{\"EmployeeId\":17,\"TaskId\":7},{\"EmployeeId\":21,\"TaskId\":7},{\"EmployeeId\":5,\"TaskId\":8},{\"EmployeeId\":8,\"TaskId\":8},{\"EmployeeId\":24,\"TaskId\":8},{\"EmployeeId\":6,\"TaskId\":9},{\"EmployeeId\":12,\"TaskId\":9},{\"EmployeeId\":14,\"TaskId\":9},{\"EmployeeId\":16,\"TaskId\":9},{\"EmployeeId\":21,\"TaskId\":9},{\"EmployeeId\":25,\"TaskId\":9},{\"EmployeeId\":5,\"TaskId\":10},{\"EmployeeId\":9,\"TaskId\":10},{\"EmployeeId\":13,\"TaskId\":10},{\"EmployeeId\":15,\"TaskId\":10},{\"EmployeeId\":20,\"TaskId\":11},{\"EmployeeId\":2,\"TaskId\":12},{\"EmployeeId\":3,\"TaskId\":12},{\"EmployeeId\":20,\"TaskId\":12},{\"EmployeeId\":11,\"TaskId\":13},{\"EmployeeId\":17,\"TaskId\":13},{\"EmployeeId\":19,\"TaskId\":13},{\"EmployeeId\":23,\"TaskId\":13},{\"EmployeeId\":4,\"TaskId\":14},{\"EmployeeId\":15,\"TaskId\":14},{\"EmployeeId\":5,\"TaskId\":15},{\"EmployeeId\":7,\"TaskId\":15},{\"EmployeeId\":14,\"TaskId\":15},{\"EmployeeId\":17,\"TaskId\":15},{\"EmployeeId\":18,\"TaskId\":15},{\"EmployeeId\":23,\"TaskId\":15},{\"EmployeeId\":2,\"TaskId\":16},{\"EmployeeId\":3,\"TaskId\":16},{\"EmployeeId\":15,\"TaskId\":16},{\"EmployeeId\":17,\"TaskId\":16},{\"EmployeeId\":19,\"TaskId\":16},{\"EmployeeId\":2,\"TaskId\":17},{\"EmployeeId\":15,\"TaskId\":17},{\"EmployeeId\":24,\"TaskId\":17},{\"EmployeeId\":3,\"TaskId\":18},{\"EmployeeId\":18,\"TaskId\":18},{\"EmployeeId\":2,\"TaskId\":19},{\"EmployeeId\":10,\"TaskId\":19},{\"EmployeeId\":12,\"TaskId\":19},{\"EmployeeId\":13,\"TaskId\":19},{\"EmployeeId\":17,\"TaskId\":20},{\"EmployeeId\":23,\"TaskId\":20},{\"EmployeeId\":9,\"TaskId\":21},{\"EmployeeId\":15,\"TaskId\":21},{\"EmployeeId\":19,\"TaskId\":21},{\"EmployeeId\":3,\"TaskId\":22},{\"EmployeeId\":7,\"TaskId\":22},{\"EmployeeId\":8,\"TaskId\":22},{\"EmployeeId\":15,\"TaskId\":22},{\"EmployeeId\":22,\"TaskId\":22},{\"EmployeeId\":6,\"TaskId\":23},{\"EmployeeId\":25,\"TaskId\":24},{\"EmployeeId\":2,\"TaskId\":25},{\"EmployeeId\":3,\"TaskId\":25},{\"EmployeeId\":21,\"TaskId\":25},{\"EmployeeId\":5,\"TaskId\":26},{\"EmployeeId\":11,\"TaskId\":26},{\"EmployeeId\":20,\"TaskId\":26},{\"EmployeeId\":22,\"TaskId\":26},{\"EmployeeId\":23,\"TaskId\":27},{\"EmployeeId\":13,\"TaskId\":28},{\"EmployeeId\":14,\"TaskId\":28},{\"EmployeeId\":15,\"TaskId\":28},{\"EmployeeId\":2,\"TaskId\":29},{\"EmployeeId\":10,\"TaskId\":29},{\"EmployeeId\":15,\"TaskId\":29},{\"EmployeeId\":19,\"TaskId\":29},{\"EmployeeId\":1,\"TaskId\":30},{\"EmployeeId\":3,\"TaskId\":30},{\"EmployeeId\":14,\"TaskId\":30},{\"EmployeeId\":21,\"TaskId\":30},{\"EmployeeId\":23,\"TaskId\":30},{\"EmployeeId\":7,\"TaskId\":31},{\"EmployeeId\":8,\"TaskId\":31},{\"EmployeeId\":13,\"TaskId\":31},{\"EmployeeId\":15,\"TaskId\":31},{\"EmployeeId\":23,\"TaskId\":31},{\"EmployeeId\":1,\"TaskId\":32},{\"EmployeeId\":7,\"TaskId\":32},{\"EmployeeId\":2,\"TaskId\":33},{\"EmployeeId\":5,\"TaskId\":33},{\"EmployeeId\":12,\"TaskId\":33},{\"EmployeeId\":16,\"TaskId\":33},{\"EmployeeId\":1,\"TaskId\":34},{\"EmployeeId\":3,\"TaskId\":34},{\"EmployeeId\":4,\"TaskId\":34},{\"EmployeeId\":16,\"TaskId\":34},{\"EmployeeId\":18,\"TaskId\":34},{\"EmployeeId\":21,\"TaskId\":34},{\"EmployeeId\":6,\"TaskId\":35},{\"EmployeeId\":7,\"TaskId\":35},{\"EmployeeId\":13,\"TaskId\":35},{\"EmployeeId\":20,\"TaskId\":35},{\"EmployeeId\":21,\"TaskId\":35},{\"EmployeeId\":23,\"TaskId\":35},{\"EmployeeId\":1,\"TaskId\":36},{\"EmployeeId\":5,\"TaskId\":36},{\"EmployeeId\":13,\"TaskId\":36},{\"EmployeeId\":22,\"TaskId\":36},{\"EmployeeId\":2,\"TaskId\":37},{\"EmployeeId\":11,\"TaskId\":37},{\"EmployeeId\":14,\"TaskId\":37},{\"EmployeeId\":21,\"TaskId\":37},{\"EmployeeId\":22,\"TaskId\":37},{\"EmployeeId\":23,\"TaskId\":37},{\"EmployeeId\":3,\"TaskId\":38},{\"EmployeeId\":6,\"TaskId\":38},{\"EmployeeId\":15,\"TaskId\":38},{\"EmployeeId\":3,\"TaskId\":39},{\"EmployeeId\":19,\"TaskId\":39},{\"EmployeeId\":13,\"TaskId\":40},{\"EmployeeId\":12,\"TaskId\":41},{\"EmployeeId\":15,\"TaskId\":41},{\"EmployeeId\":24,\"TaskId\":41},{\"EmployeeId\":2,\"TaskId\":42},{\"EmployeeId\":7,\"TaskId\":42},{\"EmployeeId\":8,\"TaskId\":42},{\"EmployeeId\":12,\"TaskId\":42},{\"EmployeeId\":16,\"TaskId\":42},{\"EmployeeId\":17,\"TaskId\":42},{\"EmployeeId\":4,\"TaskId\":43},{\"EmployeeId\":3,\"TaskId\":44},{\"EmployeeId\":16,\"TaskId\":44},{\"EmployeeId\":23,\"TaskId\":44},{\"EmployeeId\":25,\"TaskId\":44},{\"EmployeeId\":1,\"TaskId\":45},{\"EmployeeId\":16,\"TaskId\":45},{\"EmployeeId\":25,\"TaskId\":45},{\"EmployeeId\":13,\"TaskId\":46},{\"EmployeeId\":16,\"TaskId\":46},{\"EmployeeId\":6,\"TaskId\":47},{\"EmployeeId\":17,\"TaskId\":47},{\"EmployeeId\":3,\"TaskId\":48},{\"EmployeeId\":13,\"TaskId\":48},{\"EmployeeId\":17,\"TaskId\":48},{\"EmployeeId\":25,\"TaskId\":48},{\"EmployeeId\":3,\"TaskId\":49},{\"EmployeeId\":5,\"TaskId\":49},{\"EmployeeId\":21,\"TaskId\":49},{\"EmployeeId\":23,\"TaskId\":49},{\"EmployeeId\":12,\"TaskId\":50},{\"EmployeeId\":3,\"TaskId\":51},{\"EmployeeId\":5,\"TaskId\":51},{\"EmployeeId\":21,\"TaskId\":51},{\"EmployeeId\":14,\"TaskId\":53},{\"EmployeeId\":17,\"TaskId\":53},{\"EmployeeId\":9,\"TaskId\":54},{\"EmployeeId\":15,\"TaskId\":54},{\"EmployeeId\":17,\"TaskId\":54},{\"EmployeeId\":22,\"TaskId\":54},{\"EmployeeId\":11,\"TaskId\":55},{\"EmployeeId\":14,\"TaskId\":55},{\"EmployeeId\":4,\"TaskId\":56},{\"EmployeeId\":8,\"TaskId\":56},{\"EmployeeId\":13,\"TaskId\":56},{\"EmployeeId\":14,\"TaskId\":56},{\"EmployeeId\":16,\"TaskId\":56},{\"EmployeeId\":2,\"TaskId\":57},{\"EmployeeId\":20,\"TaskId\":57},{\"EmployeeId\":5,\"TaskId\":58},{\"EmployeeId\":18,\"TaskId\":58},{\"EmployeeId\":2,\"TaskId\":59},{\"EmployeeId\":12,\"TaskId\":59},{\"EmployeeId\":14,\"TaskId\":59},{\"EmployeeId\":15,\"TaskId\":59},{\"EmployeeId\":4,\"TaskId\":60},{\"EmployeeId\":2,\"TaskId\":61},{\"EmployeeId\":8,\"TaskId\":62},{\"EmployeeId\":13,\"TaskId\":62},{\"EmployeeId\":24,\"TaskId\":62},{\"EmployeeId\":7,\"TaskId\":63},{\"EmployeeId\":14,\"TaskId\":63},{\"EmployeeId\":20,\"TaskId\":63},{\"EmployeeId\":22,\"TaskId\":63},{\"EmployeeId\":23,\"TaskId\":63},{\"EmployeeId\":7,\"TaskId\":64},{\"EmployeeId\":16,\"TaskId\":64},{\"EmployeeId\":23,\"TaskId\":64},{\"EmployeeId\":1,\"TaskId\":65},{\"EmployeeId\":6,\"TaskId\":65},{\"EmployeeId\":11,\"TaskId\":65},{\"EmployeeId\":14,\"TaskId\":65},{\"EmployeeId\":15,\"TaskId\":65},{\"EmployeeId\":17,\"TaskId\":65},{\"EmployeeId\":22,\"TaskId\":65},{\"EmployeeId\":15,\"TaskId\":66},{\"EmployeeId\":1,\"TaskId\":67},{\"EmployeeId\":3,\"TaskId\":67},{\"EmployeeId\":11,\"TaskId\":67},{\"EmployeeId\":14,\"TaskId\":67},{\"EmployeeId\":25,\"TaskId\":67},{\"EmployeeId\":10,\"TaskId\":68},{\"EmployeeId\":11,\"TaskId\":68},{\"EmployeeId\":23,\"TaskId\":68},{\"EmployeeId\":2,\"TaskId\":69},{\"EmployeeId\":14,\"TaskId\":69},{\"EmployeeId\":2,\"TaskId\":70},{\"EmployeeId\":8,\"TaskId\":70},{\"EmployeeId\":16,\"TaskId\":70},{\"EmployeeId\":6,\"TaskId\":71},{\"EmployeeId\":13,\"TaskId\":71},{\"EmployeeId\":10,\"TaskId\":72},{\"EmployeeId\":11,\"TaskId\":72},{\"EmployeeId\":16,\"TaskId\":72},{\"EmployeeId\":17,\"TaskId\":72},{\"EmployeeId\":17,\"TaskId\":73},{\"EmployeeId\":18,\"TaskId\":73},{\"EmployeeId\":23,\"TaskId\":73},{\"EmployeeId\":2,\"TaskId\":74},{\"EmployeeId\":5,\"TaskId\":74},{\"EmployeeId\":8,\"TaskId\":74},{\"EmployeeId\":13,\"TaskId\":74},{\"EmployeeId\":15,\"TaskId\":74},{\"EmployeeId\":16,\"TaskId\":74},{\"EmployeeId\":17,\"TaskId\":74},{\"EmployeeId\":6,\"TaskId\":75},{\"EmployeeId\":9,\"TaskId\":75},{\"EmployeeId\":16,\"TaskId\":75},{\"EmployeeId\":19,\"TaskId\":75},{\"EmployeeId\":20,\"TaskId\":75}]}";

        var datasets = JsonConvert.DeserializeObject<Dictionary<string, IEnumerable<JObject>>>(datasetsJson);

        foreach (var dataset in datasets)
        {
            var entityType = GetType(dataset.Key);
            var entities = dataset.Value
                .Select(j => j.ToObject(entityType))
                .ToArray();

            context.AddRange(entities);
        }

        context.SaveChanges();
    }

    private static Type GetType(string modelName)
    {
        var modelType = CurrentAssembly
            .GetTypes()
            .FirstOrDefault(t => t.Name == modelName);

        Assert.IsNotNull(modelType, $"{modelName} model not found!");

        return modelType;
    }

    private static IServiceProvider ConfigureServices<TContext>(string databaseName)
        where TContext : DbContext
    {
        var services = ConfigureDbContext<TContext>(databaseName);

        var context = services.GetService<TContext>();

        try
        {
            context.Model.GetEntityTypes();
        }
        catch (InvalidOperationException ex) when (ex.Source == "Microsoft.EntityFrameworkCore.Proxies")
        {
            services = ConfigureDbContext<TContext>(databaseName, useLazyLoading: true);
        }

        return services;
    }

    private static IServiceProvider ConfigureDbContext<TContext>(string databaseName, bool useLazyLoading = false)
        where TContext : DbContext
    {
        var services = new ServiceCollection()
           .AddDbContext<TContext>(t => t
           .UseInMemoryDatabase(Guid.NewGuid().ToString())
           );

        var serviceProvider = services.BuildServiceProvider();
        return serviceProvider;
    }
}